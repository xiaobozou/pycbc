

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>pycbc.inference package &mdash; PyCBC 3b6f5b documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/terminal.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pycbc.inject package" href="pycbc.inject.html" />
    <link rel="prev" title="pycbc.frame package" href="pycbc.frame.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PyCBC
          

          
          </a>

          
            
            
              <div class="version">
                1.12.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="credit.html">Use of PyCBC in Scientific Publications</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Running PyCBC under Docker</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing PyCBC</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="workflow/pycbc_make_psd_estimation_workflow.html"><code class="docutils literal notranslate"><span class="pre">pycbc_make_psd_estimation_workflow</span></code>: A workflow generator for noise estimation</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow/pycbc_make_coinc_search_workflow.html"><code class="docutils literal notranslate"><span class="pre">pycbc_make_coinc_search_workflow</span></code>: A workflow to search for gravitational waves</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow/pygrb.html"><code class="docutils literal notranslate"><span class="pre">pycbc_make_offline_grb_workflow</span></code>: A GRB triggered CBC analysis workflow generator</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="inference.html">PyCBC inference documentation (<code class="docutils literal notranslate"><span class="pre">pycbc.inference</span></code>)</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tmpltbank.html">PyCBC template bank generation documentation (<code class="docutils literal notranslate"><span class="pre">pycbc.tmpltbank</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hwinj.html">Hardware injection waveform generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="banksim.html">Calculating the Effectualness (Fitting Factor) of Template Banks</a></li>
<li class="toctree-l1"><a class="reference internal" href="faithsim.html">Dag Generator for Doing Faithfulness Comparisons</a></li>
<li class="toctree-l1"><a class="reference internal" href="upload_to_gracedb.html">Uploading triggers to gracedb</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="catalog.html">Catalog of Observed Gravitational-wave Mergers</a></li>
<li class="toctree-l1"><a class="reference internal" href="gw150914.html">Signal Processing with GW150914</a></li>
<li class="toctree-l1"><a class="reference internal" href="frame.html">Reading Gravitational-wave Frames</a></li>
<li class="toctree-l1"><a class="reference internal" href="psd.html">Handling PSDs</a></li>
<li class="toctree-l1"><a class="reference internal" href="noise.html">Generating Noise</a></li>
<li class="toctree-l1"><a class="reference internal" href="waveform.html">Waveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="filter.html">Filtering</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributions.html">Using PyCBC Distributions from PyCBC Inference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="building_bundled_executables.html">Building Bundled Executables</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="documentation.html">Documenting PyCBC code</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Creating Releases of PyCBC</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="formats/hdf_format.html">HDF files within the PyCBC workflow</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Workflow: the inspiral analysis workflow generator (<code class="docutils literal notranslate"><span class="pre">pycbc.workflow</span></code>)</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pycbc</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="pycbc.html">pycbc package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="pycbc.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="pycbc.catalog.html">pycbc.catalog package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.distributions.html">pycbc.distributions package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.events.html">pycbc.events package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.fft.html">pycbc.fft package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.filter.html">pycbc.filter package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.frame.html">pycbc.frame package</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">pycbc.inference package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.inject.html">pycbc.inject package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.io.html">pycbc.io package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.noise.html">pycbc.noise package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.population.html">pycbc.population package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.psd.html">pycbc.psd package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.results.html">pycbc.results package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.strain.html">pycbc.strain package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.tmpltbank.html">pycbc.tmpltbank package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.types.html">pycbc.types package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.vetoes.html">pycbc.vetoes package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.waveform.html">pycbc.waveform package</a></li>
<li class="toctree-l4"><a class="reference internal" href="pycbc.workflow.html">pycbc.workflow package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.bin_utils">pycbc.bin_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.boundaries">pycbc.boundaries module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.conversions">pycbc.conversions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.coordinates">pycbc.coordinates module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.cosmology">pycbc.cosmology module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.detector">pycbc.detector module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.libutils">pycbc.libutils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.opt">pycbc.opt module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.pnutils">pycbc.pnutils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.pool">pycbc.pool module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.rate">pycbc.rate module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.scheme">pycbc.scheme module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.sensitivity">pycbc.sensitivity module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.transforms">pycbc.transforms module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.version">pycbc.version module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc.weave">pycbc.weave module</a></li>
<li class="toctree-l3"><a class="reference internal" href="pycbc.html#module-pycbc">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PyCBC</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
          <li><a href="modules.html">pycbc</a> &raquo;</li>
        
          <li><a href="pycbc.html">pycbc package</a> &raquo;</li>
        
      <li>pycbc.inference package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/pycbc.inference.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="pycbc-inference-package">
<h1>pycbc.inference package<a class="headerlink" href="#pycbc-inference-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pycbc.inference.burn_in">
<span id="pycbc-inference-burn-in-module"></span><h2>pycbc.inference.burn_in module<a class="headerlink" href="#module-pycbc.inference.burn_in" title="Permalink to this headline">¶</a></h2>
<p>This modules provides classes and functions for determining when Markov Chains
have burned in.</p>
<dl class="class">
<dt id="pycbc.inference.burn_in.BurnIn">
<em class="property">class </em><code class="descclassname">pycbc.inference.burn_in.</code><code class="descname">BurnIn</code><span class="sig-paren">(</span><em>function_names</em>, <em>min_iterations=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#BurnIn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.BurnIn" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class to estimate the number of burn in iterations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function_names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – List of name of burn in functions to use. All names in the provided
list muset be in the <cite>burn_in_functions</cite> dict. If none provided, will
use no burn-in functions.</li>
<li><strong>min_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Minimum number of burn in iterations to use. The burn in iterations
returned by evaluate will be the maximum of this value
and the values returned by the burn in functions provided in
<cite>function_names</cite>. Default is 0.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Initialize a <cite>BurnIn</cite> instance that will use <cite>max_posterior</cite> and
<cite>posterior_step</cite> as the burn in criteria:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pycbc</span> <span class="k">import</span> <span class="n">inference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">burn_in</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">BurnIn</span><span class="p">([</span><span class="s1">&#39;max_posterior&#39;</span><span class="p">,</span> <span class="s1">&#39;posterior_step&#39;</span><span class="p">])</span>
</pre></div>
</div>
<p>Use this <cite>BurnIn</cite> instance to find the burn-in iteration of each walker
in an inference result file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pycbc.io</span> <span class="k">import</span> <span class="n">InferenceFile</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fp</span> <span class="o">=</span> <span class="n">InferenceFile</span><span class="p">(</span><span class="s1">&#39;inference.hdf&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">burn_in</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">inference</span><span class="o">.</span><span class="n">samplers</span><span class="p">[</span><span class="n">fp</span><span class="o">.</span><span class="n">sampler_name</span><span class="p">],</span> <span class="n">fp</span><span class="p">)</span>
<span class="go">array([11486, 11983, 11894, ..., 11793, 11888, 11981])</span>
</pre></div>
</div>
<dl class="method">
<dt id="pycbc.inference.burn_in.BurnIn.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>sampler</em>, <em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#BurnIn.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.BurnIn.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates sampler’s chains to find burn in.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampler</strong> (<em>pycbc.inference.sampler</em>) – Sampler to determine burn in for. May be either an instance of a
<cite>inference.sampler</cite>, or the class itself.</li>
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – Open inference hdf file containing the samples to load for
determing burn in.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>burnidx</strong> (<em>array</em>) – Array of indices giving the burn-in index for each chain.</li>
<li><strong>is_burned_in</strong> (<em>array</em>) – Array of booleans indicating whether each chain is burned in.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.burn_in.BurnIn.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>sampler</em>, <em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#BurnIn.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.BurnIn.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates burn in and saves the updated indices to the given file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampler</strong> (<em>pycbc.inference.sampler</em>) – Sampler to determine burn in for. May be either an instance of a
<cite>inference.sampler</cite>, or the class itself.</li>
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – Open inference hdf file containing the samples to load for
determing burn in.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>burnidx</strong> (<em>array</em>) – Array of indices giving the burn-in index for each chain.</li>
<li><strong>is_burned_in</strong> (<em>array</em>) – Array of booleans indicating whether each chain is burned in.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="pycbc.inference.burn_in.acl_or_max_posterior">
<code class="descclassname">pycbc.inference.burn_in.</code><code class="descname">acl_or_max_posterior</code><span class="sig-paren">(</span><em>sampler</em>, <em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#acl_or_max_posterior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.acl_or_max_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Burn in that uses the minimum of <cite>n_acl</cite> and <cite>max_posteior</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.burn_in.half_chain">
<code class="descclassname">pycbc.inference.burn_in.</code><code class="descname">half_chain</code><span class="sig-paren">(</span><em>sampler</em>, <em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#half_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.half_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the second half of the iterations as post-burn in.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampler</strong> (<em>pycbc.inference.sampler</em>) – This option is not used; it is just here give consistent API as the
other burn in functions.</li>
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – Open inference hdf file containing the samples to load for determing
burn in.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>burn_in_idx</strong> (<em>array</em>) – Array of indices giving the burn-in index for each chain.</li>
<li><strong>is_burned_in</strong> (<em>array</em>) – Array of booleans indicating whether each chain is burned in.
By definition of this function, all values are set to True.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.burn_in.ks_test">
<code class="descclassname">pycbc.inference.burn_in.</code><code class="descname">ks_test</code><span class="sig-paren">(</span><em>sampler</em>, <em>fp</em>, <em>threshold=0.9</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#ks_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.ks_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Burn in based on whether the p-value of the KS test between the samples
at the last iteration and the samples midway along the chain for each
parameter is &gt; <code class="docutils literal notranslate"><span class="pre">threshold</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampler</strong> (<em>pycbc.inference.sampler</em>) – Sampler to determine burn in for. May be either an instance of a
<cite>inference.sampler</cite>, or the class itself.</li>
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – Open inference hdf file containing the samples to load for determing
burn in.</li>
<li><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – The thershold to use for the p-value. Default is 0.9.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>burn_in_idx</strong> (<em>array</em>) – Array of indices giving the burn-in index for each chain.</li>
<li><strong>is_burned_in</strong> (<em>array</em>) – Array of booleans indicating whether each chain is burned in.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.burn_in.max_posterior">
<code class="descclassname">pycbc.inference.burn_in.</code><code class="descname">max_posterior</code><span class="sig-paren">(</span><em>sampler</em>, <em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#max_posterior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.max_posterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Burn in based on samples being within dim/2 of maximum posterior.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampler</strong> (<em>pycbc.inference.sampler</em>) – Sampler to determine burn in for. May be either an instance of a
<cite>inference.sampler</cite>, or the class itself.</li>
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – Open inference hdf file containing the samples to load for determing
burn in.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>burn_in_idx</strong> (<em>array</em>) – Array of indices giving the burn-in index for each chain.</li>
<li><strong>is_burned_in</strong> (<em>array</em>) – Array of booleans indicating whether each chain is burned in.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.burn_in.n_acl">
<code class="descclassname">pycbc.inference.burn_in.</code><code class="descname">n_acl</code><span class="sig-paren">(</span><em>sampler</em>, <em>fp</em>, <em>nacls=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#n_acl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.n_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Burn in based on ACL.</p>
<p>This applies the following test to determine burn in:</p>
<ol class="arabic simple">
<li>The first half of the samples are ignored.</li>
<li>An ACL is calculated from the second half.</li>
<li>If the <code class="docutils literal notranslate"><span class="pre">nacls</span></code> times the ACL is &lt; the number of iterations / 2,
the sampler is considered to be burned in at the half-way point.</li>
</ol>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampler</strong> (<em>pycbc.inference.sampler</em>) – Sampler to determine burn in for. May be either an instance of a
<cite>inference.sampler</cite>, or the class itself.</li>
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – Open inference hdf file containing the samples to load for determing
burn in.</li>
<li><strong>nacls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of ACLs to use for burn in. Default is 5.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>burn_in_idx</strong> (<em>array</em>) – Array of indices giving the burn-in index for each chain. By definition
of this function, all chains reach burn in at the same iteration. Thus
the returned array is the burn-in index repeated by the number of
chains.</li>
<li><strong>is_burned_in</strong> (<em>array</em>) – Array of booleans indicating whether each chain is burned in. Since
all chains obtain burn in at the same time, this is either an array
of all False or True.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.burn_in.posterior_step">
<code class="descclassname">pycbc.inference.burn_in.</code><code class="descname">posterior_step</code><span class="sig-paren">(</span><em>sampler</em>, <em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#posterior_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.posterior_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Burn in based on the last time a chain made a jump &gt; dim/2.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampler</strong> (<em>pycbc.inference.sampler</em>) – Sampler to determine burn in for. May be either an instance of a
<cite>inference.sampler</cite>, or the class itself.</li>
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – Open inference hdf file containing the samples to load for determing
burn in.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>burn_in_idx</strong> (<em>array</em>) – Array of indices giving the burn-in index for each chain.</li>
<li><strong>is_burned_in</strong> (<em>array</em>) – Array of booleans indicating whether each chain is burned in.
By definition of this function, all values are set to True.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.burn_in.use_sampler">
<code class="descclassname">pycbc.inference.burn_in.</code><code class="descname">use_sampler</code><span class="sig-paren">(</span><em>sampler</em>, <em>fp=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/burn_in.html#use_sampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.burn_in.use_sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the sampler’s burn_in function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sampler</strong> (<em>pycbc.inference.sampler</em>) – Sampler to determine burn in for. Must be an instance of an
<cite>inference.sampler</cite> that has a <cite>burn_in</cite> function.</li>
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a><em>, </em><em>optional</em>) – This option is not used; it is just here give consistent API as the
other burn in functions.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>burn_in_idx</strong> (<em>array</em>) – Array of indices giving the burn-in index for each chain.</li>
<li><strong>is_burned_in</strong> (<em>array</em>) – Array of booleans indicating whether each chain is burned in.
Since the sampler’s burn in function will run until all chains
are burned, all values are set to True.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pycbc.inference.entropy">
<span id="pycbc-inference-entropy-module"></span><h2>pycbc.inference.entropy module<a class="headerlink" href="#module-pycbc.inference.entropy" title="Permalink to this headline">¶</a></h2>
<p>The module contains functions for calculating the
Kullback-Leibler divergence.</p>
<dl class="function">
<dt id="pycbc.inference.entropy.kl">
<code class="descclassname">pycbc.inference.entropy.</code><code class="descname">kl</code><span class="sig-paren">(</span><em>samples1</em>, <em>samples2</em>, <em>pdf1=False</em>, <em>pdf2=False</em>, <em>bins=30</em>, <em>hist_min=None</em>, <em>hist_max=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/entropy.html#kl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.entropy.kl" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the Kullback-Leibler divergence for a single parameter
from two distributions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples1</strong> (<em>numpy.array</em>) – Samples or probability density function (must also set <cite>pdf1=True</cite>).</li>
<li><strong>samples2</strong> (<em>numpy.array</em>) – Samples or probability density function (must also set <cite>pdf2=True</cite>).</li>
<li><strong>pdf1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Set to <cite>True</cite> if <cite>samples1</cite> is a probability density funtion already.</li>
<li><strong>pdf2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Set to <cite>True</cite> if <cite>samples2</cite> is a probability density funtion already.</li>
<li><strong>bins</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of bins to use when calculating probability density function
from a set of samples of the distribution.</li>
<li><strong>hist_min</strong> (<em>numpy.float64</em>) – Minimum of the distributions’ values to use.</li>
<li><strong>hist_max</strong> (<em>numpy.float64</em>) – Maximum of the distributions’ values to use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The Kullback-Leibler divergence value.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.float64</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pycbc.inference.gelman_rubin">
<span id="pycbc-inference-gelman-rubin-module"></span><h2>pycbc.inference.gelman_rubin module<a class="headerlink" href="#module-pycbc.inference.gelman_rubin" title="Permalink to this headline">¶</a></h2>
<p>This modules provides functions for evaluating the Gelman-Rubin convergence
diagnostic statistic.</p>
<dl class="function">
<dt id="pycbc.inference.gelman_rubin.gelman_rubin">
<code class="descclassname">pycbc.inference.gelman_rubin.</code><code class="descname">gelman_rubin</code><span class="sig-paren">(</span><em>chains</em>, <em>auto_burn_in=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/gelman_rubin.html#gelman_rubin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.gelman_rubin.gelman_rubin" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the univariate Gelman-Rubin convergence statistic
which compares the evolution of multiple chains in a Markov-Chain Monte
Carlo process and computes their difference to determine their convergence.
The between-chain and within-chain variances are computed for each sampling
parameter, and a weighted combination of the two is used to determine the
convergence. As the chains converge, the point scale reduction factor
should go to 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chains</strong> (<em>iterable</em>) – An iterable of numpy.array instances that contain the samples
for each chain. Each chain has shape (nparameters, niterations).</li>
<li><strong>auto_burn_in</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If True, then only use later half of samples provided.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>psrf</strong> – A numpy.array of shape (nparameters) that has the point estimates of
the potential scale reduction factor.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">numpy.array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.gelman_rubin.walk">
<code class="descclassname">pycbc.inference.gelman_rubin.</code><code class="descname">walk</code><span class="sig-paren">(</span><em>chains</em>, <em>start</em>, <em>end</em>, <em>step</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/gelman_rubin.html#walk"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.gelman_rubin.walk" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates Gelman-Rubin conervergence statistic along chains of data.
This function will advance along the chains and calculate the
statistic for each step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>chains</strong> (<em>iterable</em>) – An iterable of numpy.array instances that contain the samples
for each chain. Each chain has shape (nparameters, niterations).</li>
<li><strong>start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Start index of blocks to calculate all statistics.</li>
<li><strong>end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Last index of blocks to calculate statistics.</li>
<li><strong>step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – Step size to take for next block.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>starts</strong> (<em>numpy.array</em>) – 1-D array of start indexes of calculations.</li>
<li><strong>ends</strong> (<em>numpy.array</em>) – 1-D array of end indexes of caluclations.</li>
<li><strong>stats</strong> (<em>numpy.array</em>) – Array with convergence statistic. It has
shape (nparameters, ncalculations).</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pycbc.inference.geweke">
<span id="pycbc-inference-geweke-module"></span><h2>pycbc.inference.geweke module<a class="headerlink" href="#module-pycbc.inference.geweke" title="Permalink to this headline">¶</a></h2>
<p>Functions for computing the Geweke convergence statistic.</p>
<dl class="function">
<dt id="pycbc.inference.geweke.geweke">
<code class="descclassname">pycbc.inference.geweke.</code><code class="descname">geweke</code><span class="sig-paren">(</span><em>x</em>, <em>seg_length</em>, <em>seg_stride</em>, <em>end_idx</em>, <em>ref_start</em>, <em>ref_end=None</em>, <em>seg_start=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/geweke.html#geweke"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.geweke.geweke" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates Geweke conervergence statistic for a chain of data.
This function will advance along the chain and calculate the
statistic for each step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>x</strong> (<em>numpy.array</em>) – A one-dimensional array of data.</li>
<li><strong>seg_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of samples to use for each Geweke calculation.</li>
<li><strong>seg_stride</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of samples to advance before next Geweke calculation.</li>
<li><strong>end_idx</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of last start.</li>
<li><strong>ref_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of beginning of end reference segment.</li>
<li><strong>ref_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of end of end reference segment. Default is None which
will go to the end of the data array.</li>
<li><strong>seg_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – What index to start computing the statistic. Default is 0 which
will go to the beginning of the data array.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>starts</strong> (<em>numpy.array</em>) – The start index of the first segment in the chain.</li>
<li><strong>ends</strong> (<em>numpy.array</em>) – The end index of the first segment in the chain.</li>
<li><strong>stats</strong> (<em>numpy.array</em>) – The Geweke convergence diagnostic statistic for the segment.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pycbc.inference.likelihood">
<span id="pycbc-inference-likelihood-module"></span><h2>pycbc.inference.likelihood module<a class="headerlink" href="#module-pycbc.inference.likelihood" title="Permalink to this headline">¶</a></h2>
<p>This modules provides classes and functions for evaluating the log likelihood
for parameter estimation.</p>
<dl class="class">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator">
<em class="property">class </em><code class="descclassname">pycbc.inference.likelihood.</code><code class="descname">BaseLikelihoodEvaluator</code><span class="sig-paren">(</span><em>variable_args</em>, <em>waveform_generator=None</em>, <em>data=None</em>, <em>prior=None</em>, <em>sampling_parameters=None</em>, <em>replace_parameters=None</em>, <em>sampling_transforms=None</em>, <em>waveform_transforms=None</em>, <em>return_meta=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Base container class for generating waveforms, storing the data, and
computing posteriors.</p>
<p>The nomenclature used by this class and those that inherit from it is as
follows: Given some model parameters <span class="math notranslate nohighlight">\(\Theta\)</span> and some data
<span class="math notranslate nohighlight">\(d\)</span> with noise model <span class="math notranslate nohighlight">\(n\)</span>, we define:</p>
<blockquote>
<div><ul class="simple">
<li>the <strong>likelihood function</strong>: <span class="math notranslate nohighlight">\(p(d|\Theta)\)</span></li>
<li>the <strong>noise likelihood</strong>: <span class="math notranslate nohighlight">\(p(d|n)\)</span></li>
<li>the <strong>likelihood ratio</strong>: <span class="math notranslate nohighlight">\(\mathcal{L}(\Theta) = \frac{p(d|\Theta)}{p(d|n)}\)</span></li>
<li>the <strong>prior</strong>: <span class="math notranslate nohighlight">\(p(\Theta)\)</span></li>
<li>the <strong>posterior</strong>: <span class="math notranslate nohighlight">\(p(\Theta|d) \propto p(d|\Theta)p(\Theta)\)</span></li>
<li>the <strong>prior-weighted likelihood ratio</strong>: <span class="math notranslate nohighlight">\(\hat{\mathcal{L}}(\Theta) = \frac{p(d|\Theta)p(\Theta)}{p(d|n)}\)</span></li>
<li>the <strong>SNR</strong>: <span class="math notranslate nohighlight">\(\rho(\Theta) = \sqrt{2\log\mathcal{L}(\Theta)}\)</span>; for
two detectors, this is approximately the same quantity as the coincident
SNR used in the CBC search.</li>
</ul>
</div></blockquote>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Although the posterior probability is only proportional to
<span class="math notranslate nohighlight">\(p(d|\Theta)p(\Theta)\)</span>, here we refer to this quantity as the
posterior. Also note that for a given noise model, the prior-weighted
likelihood ratio is proportional to the posterior, and so the two can
usually be swapped for each other.</p>
</div>
<p>When performing parameter estimation we work with the log of these values
since we are mostly concerned with their values around the maxima. If
we have multiple detectors, each with data <span class="math notranslate nohighlight">\(d_i\)</span>, then these values
simply sum over the detectors. For example, the log likelihood ratio is:</p>
<div class="math notranslate nohighlight">
\[\log \mathcal{L}(\Theta) = \sum_i \left[\log p(\Theta|d_i) - \log p(n|d_i)\right]\]</div>
<p>This class provides boiler-plate methods and attributes for evaluating the
log likelihood ratio, log prior, and log likelihood. This class
makes no assumption about the detectors’ noise model <span class="math notranslate nohighlight">\(n\)</span>. As such,
the methods for computing these values raise <code class="docutils literal notranslate"><span class="pre">NotImplementedErrors</span></code>. These
functions need to be monkey patched, or other classes that inherit from
this class need to define their own functions.</p>
<p>Instances of this class can be called like a function. The default is for
this class to call its <code class="docutils literal notranslate"><span class="pre">logposterior</span></code> function, but this can be changed
with the <code class="docutils literal notranslate"><span class="pre">set_callfunc</span></code> method.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>variable_args</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</li>
<li><strong>waveform_generator</strong> (<em>generator class</em><em>, </em><em>optional</em>) – A generator class that creates waveforms.</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a><em>, </em><em>optional</em>) – A dictionary of data, in which the keys are the detector names and the
values are the data.</li>
<li><strong>prior</strong> (<em>callable</em><em>, </em><em>optional</em>) – A callable class or function that computes the log of the prior. If
None provided, will use <code class="docutils literal notranslate"><span class="pre">_noprior</span></code>, which returns 0 for all parameter
values.</li>
<li><strong>sampling_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – Replace one or more of the variable args with the given parameters
for sampling.</li>
<li><strong>replace_parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – The variable args to replace with sampling parameters. Must be the
same length as <code class="docutils literal notranslate"><span class="pre">sampling_parameters</span></code>.</li>
<li><strong>sampling_transforms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – List of transforms to use to go between the variable args and the
sampling parameters. Required if <code class="docutils literal notranslate"><span class="pre">sampling_parameters</span></code> is not None.</li>
<li><strong>waveform_transforms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a><em>, </em><em>optional</em>) – List of transforms to use to go from the variable args to parameters
understood by the waveform generator.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.waveform_generator">
<code class="descname">waveform_generator</code><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.waveform_generator" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – The waveform generator that the class was initialized with.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.data">
<code class="descname">data</code><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.data" title="Permalink to this definition">¶</a></dt>
<dd><p><em>dict</em> – The data that the class was initialized with.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.lognl">
<code class="descname">lognl</code><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.lognl" title="Permalink to this definition">¶</a></dt>
<dd><p><em>{None, float}</em> – The log of the noise likelihood summed over the number of detectors.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.return_meta">
<code class="descname">return_meta</code><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.return_meta" title="Permalink to this definition">¶</a></dt>
<dd><p><em>{True, bool}</em> – If True, <code class="docutils literal notranslate"><span class="pre">prior</span></code>, <code class="docutils literal notranslate"><span class="pre">logposterior</span></code>, and <code class="docutils literal notranslate"><span class="pre">logplr</span></code> will return the
value of the prior, the loglikelihood ratio, and the log jacobian,
along with the posterior/plr.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">logjacobian :</code></dt>
<dd><p>Returns the log of the jacobian needed to go from the parameter space
of the variable args to the sampling args.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">prior :</code></dt>
<dd><p>A function that returns the log of the prior.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">loglikelihood :</code></dt>
<dd><p>A function that returns the log of the likelihood function.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">logposterior :</code></dt>
<dd><p>A function that returns the log of the posterior.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">loglr :</code></dt>
<dd><p>A function that returns the log of the likelihood ratio.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">logplr :</code></dt>
<dd><p>A function that returns the log of the prior-weighted likelihood ratio.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">snr :</code></dt>
<dd><p>A function that returns the square root of twice the log likelihood
ratio. If the log likelihood ratio is &lt; 0, will return 0.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">evaluate :</code></dt>
<dd><p>Maps a list of values to their parameter names and calls whatever the
call function is set to.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="descname">set_callfunc :</code></dt>
<dd><p>Set the function to use when the class is called as a function.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.apply_sampling_transforms">
<code class="descname">apply_sampling_transforms</code><span class="sig-paren">(</span><em>samples</em>, <em>inverse=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.apply_sampling_transforms"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.apply_sampling_transforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the sampling transforms to the given samples.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">sampling_transforms</span></code> is None, just returns the samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a><em> or </em><a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray"><em>FieldArray</em></a>) – The samples to apply the transforms to.</li>
<li><strong>inverse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to apply the inverse transforms (i.e., go from the sampling
args to the variable args). Default is False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The transformed samples, along with the original samples.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)">dict</a> or <a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray">FieldArray</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">data</code></dt>
<dd><p>Returns the data that was set.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>params</em>, <em>callfunc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the call function at the given list of parameter values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>params</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – A list of values. These are assumed to be in the same order as
variable args.</li>
<li><strong>callfunc</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the function to call. If None, will use
<code class="docutils literal notranslate"><span class="pre">self._callfunc</span></code>. Default is None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">If <code class="docutils literal notranslate"><span class="pre">return_meta</span></code> is False, the output of the call function. If
<code class="docutils literal notranslate"><span class="pre">return_meta</span></code> is True, a tuple of the output of the call function
and the meta data.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.7)">tuple</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.logjacobian">
<code class="descname">logjacobian</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.logjacobian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.logjacobian" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log of the jacobian needed to transform pdfs in the
<code class="docutils literal notranslate"><span class="pre">variable_args</span></code> parameter space to the <code class="docutils literal notranslate"><span class="pre">sampling_args</span></code> parameter
space.</p>
<p>Let <span class="math notranslate nohighlight">\(\mathbf{x}\)</span> be the set of variable parameters,
<span class="math notranslate nohighlight">\(\mathbf{y} = f(\mathbf{x})\)</span> the set of sampling parameters, and
<span class="math notranslate nohighlight">\(p_x(\mathbf{x})\)</span> a probability density function defined over
<span class="math notranslate nohighlight">\(\mathbf{x}\)</span>. The corresponding pdf in <span class="math notranslate nohighlight">\(\mathbf{y}\)</span> is then:</p>
<div class="math notranslate nohighlight">
\[p_y(\mathbf{y}) = p_x(\mathbf{x})\left|\mathrm{det}\,\mathbf{J}_{ij}\right|,\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{J}_{ij}\)</span> is the Jacobian of the inverse transform
<span class="math notranslate nohighlight">\(\mathbf{x} = g(\mathbf{y})\)</span>. This has elements:</p>
<div class="math notranslate nohighlight">
\[\mathbf{J}_{ij} = \frac{\partial g_i}{\partial{y_j}}\]</div>
<p>This function returns
<span class="math notranslate nohighlight">\(\log \left|\mathrm{det}\,\mathbf{J}_{ij}\right|\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**params</strong> – The keyword arguments should specify values for all of the variable
args and all of the sampling args.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The value of the jacobian.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.loglikelihood">
<code class="descname">loglikelihood</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.loglikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.loglikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the natural log of the likelihood function.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.loglr">
<code class="descname">loglr</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.loglr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.loglr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the natural log of the likelihood ratio.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">lognl</code></dt>
<dd><p>Returns the log of the noise likelihood.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.logplr">
<code class="descname">logplr</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.logplr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.logplr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log of the prior-weighted likelihood ratio.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.logposterior">
<code class="descname">logposterior</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.logposterior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.logposterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log of the posterior of the given params.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.metadata_fields">
<code class="descname">metadata_fields</code><em class="property"> = ['prior', 'loglr', 'logjacobian']</em><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.metadata_fields" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.name">
<code class="descname">name</code><em class="property"> = None</em><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.prior">
<code class="descname">prior</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.prior" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should return the prior of the given params.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.prior_rvs">
<code class="descname">prior_rvs</code><span class="sig-paren">(</span><em>size=1</em>, <em>prior=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.prior_rvs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.prior_rvs" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns random variates drawn from the prior.</p>
<p>If the <code class="docutils literal notranslate"><span class="pre">sampling_args</span></code> are different from the <code class="docutils literal notranslate"><span class="pre">variable_args</span></code>, the
variates are transformed to the <cite>sampling_args</cite> parameter space before
being returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Number of random values to return for each parameter. Default is 1.</li>
<li><strong>prior</strong> (<a class="reference internal" href="pycbc.distributions.html#pycbc.distributions.joint.JointDistribution" title="pycbc.distributions.joint.JointDistribution"><em>JointDistribution</em></a><em>, </em><em>optional</em>) – Use the given prior to draw values rather than the saved prior.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A field array of the random values.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray">FieldArray</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.required_kwargs">
<code class="descname">required_kwargs</code><em class="property"> = []</em><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.required_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.sampling_args">
<code class="descname">sampling_args</code><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.sampling_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sampling arguments.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.sampling_transforms">
<code class="descname">sampling_transforms</code><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.sampling_transforms" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the sampling transforms.</p>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.set_callfunc">
<em class="property">classmethod </em><code class="descname">set_callfunc</code><span class="sig-paren">(</span><em>funcname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.set_callfunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.set_callfunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the function used when the class is called as a function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>funcname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – The name of the function to use; must be the name of an instance
method.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.set_lognl">
<code class="descname">set_lognl</code><span class="sig-paren">(</span><em>lognl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.set_lognl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.set_lognl" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the value of the log noise likelihood.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.snr">
<code class="descname">snr</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#BaseLikelihoodEvaluator.snr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.snr" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the “SNR” of the given params. This will return
imaginary values if the log likelihood ratio is &lt; 0.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.BaseLikelihoodEvaluator.variable_args">
<code class="descname">variable_args</code><a class="headerlink" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator.variable_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the variable arguments.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">waveform_generator</code></dt>
<dd><p>Returns the waveform generator that was set.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycbc.inference.likelihood.TestNormal">
<em class="property">class </em><code class="descclassname">pycbc.inference.likelihood.</code><code class="descname">TestNormal</code><span class="sig-paren">(</span><em>variable_args</em>, <em>mean=None</em>, <em>cov=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#TestNormal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.TestNormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator" title="pycbc.inference.likelihood.BaseLikelihoodEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.likelihood.BaseLikelihoodEvaluator</span></code></a></p>
<p>The test distribution is an multi-variate normal distribution.</p>
<p>The number of dimensions is set by the number of <code class="docutils literal notranslate"><span class="pre">variable_args</span></code> that are
passed. For details on the distribution used, see
<code class="docutils literal notranslate"><span class="pre">scipy.stats.multivariate_normal</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>variable_args</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</li>
<li><strong>mean</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The mean values of the parameters. If None provide, will use 0 for all
parameters.</li>
<li><strong>cov</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The covariance matrix of the parameters. If None provided, will use
unit variance for all parameters, with cross-terms set to 0.</li>
<li><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseLikelihoodEvaluator</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pycbc.inference.likelihood.TestNormal.loglikelihood">
<code class="descname">loglikelihood</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#TestNormal.loglikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.TestNormal.loglikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log pdf of the multivariate normal.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.TestNormal.name">
<code class="descname">name</code><em class="property"> = 'test_normal'</em><a class="headerlink" href="#pycbc.inference.likelihood.TestNormal.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycbc.inference.likelihood.TestEggbox">
<em class="property">class </em><code class="descclassname">pycbc.inference.likelihood.</code><code class="descname">TestEggbox</code><span class="sig-paren">(</span><em>variable_args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#TestEggbox"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.TestEggbox" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator" title="pycbc.inference.likelihood.BaseLikelihoodEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.likelihood.BaseLikelihoodEvaluator</span></code></a></p>
<p>The test distribution is an ‘eggbox’ function:</p>
<div class="math notranslate nohighlight">
\[\log \mathcal{L}(\Theta) = \left[2+\prod_{i=1}^{n}\cos\left(\frac{\theta_{i}}{2}\right)\right]^{5}\]</div>
<p>The number of dimensions is set by the number of <code class="docutils literal notranslate"><span class="pre">variable_args</span></code> that are
passed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>variable_args</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</li>
<li><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseLikelihoodEvaluator</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pycbc.inference.likelihood.TestEggbox.loglikelihood">
<code class="descname">loglikelihood</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#TestEggbox.loglikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.TestEggbox.loglikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log pdf of the eggbox function.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.TestEggbox.name">
<code class="descname">name</code><em class="property"> = 'test_eggbox'</em><a class="headerlink" href="#pycbc.inference.likelihood.TestEggbox.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycbc.inference.likelihood.TestVolcano">
<em class="property">class </em><code class="descclassname">pycbc.inference.likelihood.</code><code class="descname">TestVolcano</code><span class="sig-paren">(</span><em>variable_args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#TestVolcano"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.TestVolcano" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator" title="pycbc.inference.likelihood.BaseLikelihoodEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.likelihood.BaseLikelihoodEvaluator</span></code></a></p>
<p>The test distribution is a two-dimensional ‘volcano’ function:</p>
<div class="math notranslate nohighlight">
\[\Theta = \sqrt{\theta_{1}^{2} + \theta_{2}^{2}}
\log \mathcal{L}(\Theta) = 25(e^{\frac{-\Theta}{35}} + \frac{1}{2\sqrt{2\pi}} e^{-\frac{(\Theta-5)^{2}}{8}})\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>variable_args</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied. Must have length 2.</li>
<li><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseLikelihoodEvaluator</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pycbc.inference.likelihood.TestVolcano.loglikelihood">
<code class="descname">loglikelihood</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#TestVolcano.loglikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.TestVolcano.loglikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log pdf of the 2D volcano function.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.TestVolcano.name">
<code class="descname">name</code><em class="property"> = 'test_volcano'</em><a class="headerlink" href="#pycbc.inference.likelihood.TestVolcano.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycbc.inference.likelihood.TestRosenbrock">
<em class="property">class </em><code class="descclassname">pycbc.inference.likelihood.</code><code class="descname">TestRosenbrock</code><span class="sig-paren">(</span><em>variable_args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#TestRosenbrock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.TestRosenbrock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator" title="pycbc.inference.likelihood.BaseLikelihoodEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.likelihood.BaseLikelihoodEvaluator</span></code></a></p>
<p>The test distribution is the Rosenbrock function:</p>
<div class="math notranslate nohighlight">
\[\log \mathcal{L}(\Theta) = -\sum_{i=1}^{n-1}[(1-\theta_{i})^{2}+100(\theta_{i+1} - \theta_{i}^{2})^{2}]\]</div>
<p>The number of dimensions is set by the number of <code class="docutils literal notranslate"><span class="pre">variable_args</span></code> that are
passed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>variable_args</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</li>
<li><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseLikelihoodEvaluator</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="pycbc.inference.likelihood.TestRosenbrock.loglikelihood">
<code class="descname">loglikelihood</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#TestRosenbrock.loglikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.TestRosenbrock.loglikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log pdf of the Rosenbrock function.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.TestRosenbrock.name">
<code class="descname">name</code><em class="property"> = 'test_rosenbrock'</em><a class="headerlink" href="#pycbc.inference.likelihood.TestRosenbrock.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycbc.inference.likelihood.GaussianLikelihood">
<em class="property">class </em><code class="descclassname">pycbc.inference.likelihood.</code><code class="descname">GaussianLikelihood</code><span class="sig-paren">(</span><em>variable_args</em>, <em>waveform_generator=None</em>, <em>data=None</em>, <em>f_lower=None</em>, <em>psds=None</em>, <em>f_upper=None</em>, <em>norm=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#GaussianLikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.GaussianLikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.likelihood.BaseLikelihoodEvaluator" title="pycbc.inference.likelihood.BaseLikelihoodEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.likelihood.BaseLikelihoodEvaluator</span></code></a></p>
<p>Computes log likelihoods assuming the detectors’ noise is Gaussian.</p>
<p>With Gaussian noise the log likelihood functions for signal
<span class="math notranslate nohighlight">\(\log p(d|\Theta)\)</span> and for noise <span class="math notranslate nohighlight">\(\log p(d|n)\)</span> are given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\log p(d|\Theta) &amp;= -\frac{1}{2} \sum_i \left&lt;h_i(\Theta) - d_i | h_i(\Theta) - d_i\right&gt; \\
\log p(d|n) &amp;= -\frac{1}{2} \sum_i \left&lt;d_i | d_i\right&gt;\end{split}\]</div>
<p>where the sum is over the number of detectors, <span class="math notranslate nohighlight">\(d_i\)</span> is the data in
each detector, and <span class="math notranslate nohighlight">\(h_i(\Theta)\)</span> is the model signal in each
detector. The inner product is given by:</p>
<div class="math notranslate nohighlight">
\[\left&lt;a | b\right&gt; = 4\Re \int_{0}^{\infty} \frac{\tilde{a}(f) \tilde{b}(f)}{S_n(f)} \mathrm{d}f,\]</div>
<p>where <span class="math notranslate nohighlight">\(S_n(f)\)</span> is the PSD in the given detector.</p>
<p>Note that the log prior-weighted likelihood ratio has one less term
than the log posterior, since the <span class="math notranslate nohighlight">\(\left&lt;d_i|d_i\right&gt;\)</span> term cancels
in the likelihood ratio:</p>
<div class="math notranslate nohighlight">
\[\log \hat{\mathcal{L}} = \log p(\Theta) + \sum_i \left[ \left&lt;h_i(\Theta)|d_i\right&gt; - \frac{1}{2} \left&lt;h_i(\Theta)|h_i(\Theta)\right&gt; \right]\]</div>
<p>For this reason, by default this class returns <code class="docutils literal notranslate"><span class="pre">logplr</span></code> when called as a
function instead of <code class="docutils literal notranslate"><span class="pre">logposterior</span></code>. This can be changed via the
<code class="docutils literal notranslate"><span class="pre">set_callfunc</span></code> method.</p>
<p>Upon initialization, the data is whitened using the given PSDs. If no PSDs
are given the data and waveforms returned by the waveform generator are
assumed to be whitened. The likelihood function of the noise,</p>
<div class="math notranslate nohighlight">
\[p(d|n) = \frac{1}{2} \sum_i \left&lt;d_i|d_i\right&gt;,\]</div>
<p>is computed on initialization and stored as the <cite>lognl</cite> attribute.</p>
<p>By default, the data is assumed to be equally sampled in frequency, but
unequally sampled data can be supported by passing the appropriate
normalization using the <code class="docutils literal notranslate"><span class="pre">norm</span></code> keyword argument.</p>
<p>For more details on initialization parameters and definition of terms, see
<code class="docutils literal notranslate"><span class="pre">BaseLikelihoodEvaluator</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>variable_args</strong> (<em>(</em><em>tuple of</em><em>) </em><em>string</em><em>(</em><em>s</em><em>)</em>) – A tuple of parameter names that will be varied.</li>
<li><strong>waveform_generator</strong> (<em>generator class</em>) – A generator class that creates waveforms. This must have a <code class="docutils literal notranslate"><span class="pre">generate</span></code>
function which takes parameter values as keyword arguments, a
detectors attribute which is a dictionary of detectors keyed by their
names, and an epoch which specifies the start time of the generated
waveform.</li>
<li><strong>data</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – A dictionary of data, in which the keys are the detector names and the
values are the data (assumed to be unwhitened). The list of keys must
match the waveform generator’s detectors keys, and the epoch of every
data set must be the same as the waveform generator’s epoch.</li>
<li><strong>f_lower</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – A dictionary of starting frequencies, in which the keys are the detector
names and the values are the starting frequency for that detector to be
used for computing inner products.</li>
<li><strong>psds</strong> (<em>{None</em><em>, </em><em>dict}</em>) – A dictionary of FrequencySeries keyed by the detector names. The
dictionary must have a psd for each detector specified in the data
dictionary. If provided, the inner products in each detector will be
weighted by 1/psd of that detector.</li>
<li><strong>f_upper</strong> (<em>{None</em><em>, </em><em>float}</em>) – The ending frequency to use for computing inner products. If not
provided, the minimum of the largest frequency stored in the data
and a given waveform will be used.</li>
<li><strong>norm</strong> (<em>{None</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em> or </em><em>array}</em>) – An extra normalization weight to apply to the inner products. Can be
either a float or an array. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">4*data.values()[0].delta_f</span></code>
will be used.</li>
<li><strong>**kwargs</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">BaseLikelihoodEvaluator</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Create a signal, and set up the likelihood evaluator on that signal:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pycbc</span> <span class="k">import</span> <span class="n">psd</span> <span class="k">as</span> <span class="n">pypsd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pycbc.waveform.generator</span> <span class="k">import</span> <span class="n">FDomainDetFrameGenerator</span><span class="p">,</span> <span class="n">FDomainCBCGenerator</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pycbc</span> <span class="k">import</span> <span class="n">inference</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seglen</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_rate</span> <span class="o">=</span> <span class="mi">2048</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">seglen</span><span class="o">*</span><span class="n">sample_rate</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fmin</span> <span class="o">=</span> <span class="mf">30.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m1</span><span class="p">,</span> <span class="n">m2</span><span class="p">,</span> <span class="n">s1z</span><span class="p">,</span> <span class="n">s2z</span><span class="p">,</span> <span class="n">tsig</span><span class="p">,</span> <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">pol</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="mf">38.6</span><span class="p">,</span> <span class="mf">29.3</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">3.1</span><span class="p">,</span> <span class="mf">1.37</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.26</span><span class="p">,</span> <span class="mf">2.76</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="mf">500.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">generator</span> <span class="o">=</span> <span class="n">FDomainDetFrameGenerator</span><span class="p">(</span><span class="n">FDomainCBCGenerator</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">variable_args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;tc&#39;</span><span class="p">],</span> <span class="n">detectors</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H1&#39;</span><span class="p">,</span> <span class="s1">&#39;L1&#39;</span><span class="p">],</span> <span class="n">delta_f</span><span class="o">=</span><span class="mf">1.</span><span class="o">/</span><span class="n">seglen</span><span class="p">,</span> <span class="n">f_lower</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">approximant</span><span class="o">=</span><span class="s1">&#39;SEOBNRv2_ROM_DoubleSpin&#39;</span><span class="p">,</span> <span class="n">mass1</span><span class="o">=</span><span class="n">m1</span><span class="p">,</span> <span class="n">mass2</span><span class="o">=</span><span class="n">m2</span><span class="p">,</span> <span class="n">spin1z</span><span class="o">=</span><span class="n">s1z</span><span class="p">,</span> <span class="n">spin2z</span><span class="o">=</span><span class="n">s2z</span><span class="p">,</span> <span class="n">ra</span><span class="o">=</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">dec</span><span class="p">,</span> <span class="n">polarization</span><span class="o">=</span><span class="n">pol</span><span class="p">,</span> <span class="n">distance</span><span class="o">=</span><span class="n">dist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">signal</span> <span class="o">=</span> <span class="n">generator</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">tsig</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psd</span> <span class="o">=</span> <span class="n">pypsd</span><span class="o">.</span><span class="n">aLIGOZeroDetHighPower</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mf">1.</span><span class="o">/</span><span class="n">seglen</span><span class="p">,</span> <span class="mf">20.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">psds</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="n">psd</span><span class="p">,</span> <span class="s1">&#39;L1&#39;</span><span class="p">:</span> <span class="n">psd</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f_lower</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H1&#39;</span><span class="p">:</span> <span class="n">fmin</span><span class="p">,</span> <span class="s1">&#39;L1&#39;</span><span class="p">:</span> <span class="n">fmin</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">likelihood_eval</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">GaussianLikelihood</span><span class="p">([</span><span class="s1">&#39;tc&#39;</span><span class="p">],</span> <span class="n">generator</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">f_lower</span><span class="o">=</span><span class="n">f_lower</span><span class="p">,</span> <span class="n">psds</span><span class="o">=</span><span class="n">psds</span><span class="p">,</span> <span class="n">return_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>Now compute the log likelihood ratio and prior-weighted likelihood ratio;
since we have not provided a prior, these should be equal to each other:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">likelihood_eval</span><span class="o">.</span><span class="n">loglr</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">tsig</span><span class="p">),</span> <span class="n">likelihood_eval</span><span class="o">.</span><span class="n">logplr</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">tsig</span><span class="p">)</span>
<span class="go">    (278.9612860719217, 278.9612860719217)</span>
</pre></div>
</div>
<p>Compute the log likelihood and log posterior; since we have not
provided a prior, these should both be equal to zero:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">likelihood_eval</span><span class="o">.</span><span class="n">loglikelihood</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">tsig</span><span class="p">),</span> <span class="n">likelihood_eval</span><span class="o">.</span><span class="n">logposterior</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="n">tsig</span><span class="p">)</span>
<span class="go">    (0.0, 0.0)</span>
</pre></div>
</div>
<p>Compute the SNR; for this system and PSD, this should be approximately 24:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">likelihood_eval</span><span class="o">.</span><span class="n">snr</span><span class="p">()</span>
</pre></div>
</div>
<p>Using the same likelihood evaluator, evaluate the log prior-weighted
likelihood ratio at several points in time, check that the max is at tsig,
and plot (note that we use the class as a function here, which defaults
to calling <code class="docutils literal notranslate"><span class="pre">logplr</span></code>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">pyplot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">times</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">seglen</span><span class="o">*</span><span class="n">sample_rate</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">sample_rate</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lls</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">likelihood_eval</span><span class="p">([</span><span class="n">t</span><span class="p">])</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">times</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">times</span><span class="p">[</span><span class="n">lls</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>
<span class="go">    3.10009765625</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span> <span class="o">=</span> <span class="n">pyplot</span><span class="o">.</span><span class="n">figure</span><span class="p">();</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">lls</span><span class="p">)</span>
<span class="go">    [&lt;matplotlib.lines.Line2D at 0x1274b5c50&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Create a prior and use it (see distributions module for more details):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pycbc</span> <span class="k">import</span> <span class="n">distributions</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uniform_prior</span> <span class="o">=</span> <span class="n">distributions</span><span class="o">.</span><span class="n">Uniform</span><span class="p">(</span><span class="n">tc</span><span class="o">=</span><span class="p">(</span><span class="n">tsig</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span><span class="n">tsig</span><span class="o">+</span><span class="mf">0.2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior_eval</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">JointDistribution</span><span class="p">([</span><span class="s1">&#39;tc&#39;</span><span class="p">],</span> <span class="n">uniform_prior</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">likelihood_eval</span> <span class="o">=</span> <span class="n">inference</span><span class="o">.</span><span class="n">GaussianLikelihood</span><span class="p">(</span><span class="n">generator</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">f_lower</span><span class="o">=</span><span class="n">f_lower</span><span class="p">,</span> <span class="n">psds</span><span class="o">=</span><span class="n">psds</span><span class="p">,</span> <span class="n">prior</span><span class="o">=</span><span class="n">prior_eval</span><span class="p">,</span> <span class="n">return_meta</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">likelihood_eval</span><span class="o">.</span><span class="n">logplr</span><span class="p">([</span><span class="n">tsig</span><span class="p">]),</span> <span class="n">likelihood_eval</span><span class="o">.</span><span class="n">logposterior</span><span class="p">([</span><span class="n">tsig</span><span class="p">])</span>
<span class="go">    (ArrayWithAligned(278.84574353071264), ArrayWithAligned(0.9162907318741418))</span>
</pre></div>
</div>
<dl class="method">
<dt id="pycbc.inference.likelihood.GaussianLikelihood.loglikelihood">
<code class="descname">loglikelihood</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#GaussianLikelihood.loglikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.GaussianLikelihood.loglikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the log likelihood of the paramaters,</p>
<div class="math notranslate nohighlight">
\[p(d|\Theta) = -\frac{1}{2}\sum_i \left&lt;h_i(\Theta) - d_i | h_i(\Theta) - d_i\right&gt;\]</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**params</strong> – The keyword arguments should give the values of each parameter to
evaluate.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The value of the log likelihood evaluated at the given point.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)">float</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.GaussianLikelihood.loglr">
<code class="descname">loglr</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#GaussianLikelihood.loglr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.GaussianLikelihood.loglr" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the log likelihood ratio,</p>
<div class="math notranslate nohighlight">
\[\log \mathcal{L}(\Theta) = \sum_i \left&lt;h_i(\Theta)|d_i\right&gt; - \frac{1}{2}\left&lt;h_i(\Theta)|h_i(\Theta)\right&gt;,\]</div>
<p>at the given point in parameter space <span class="math notranslate nohighlight">\(\Theta\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**params</strong> – The keyword arguments should give the values of each parameter to
evaluate.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The value of the log likelihood ratio evaluated at the given point.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.float64</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.likelihood.GaussianLikelihood.logposterior">
<code class="descname">logposterior</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#GaussianLikelihood.logposterior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.GaussianLikelihood.logposterior" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the log-posterior probability at the given point in
parameter space.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**params</strong> – The keyword arguments should give the values of each parameter to
evaluate.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>float</em> – The value of the log-posterior evaluated at the given point in
parameter space.</li>
<li><strong>metadata</strong> (<em>tuple</em>) – If <code class="docutils literal notranslate"><span class="pre">return_meta</span></code>, the prior and likelihood ratio as a tuple.
Otherwise, just returns the log-posterior.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.GaussianLikelihood.name">
<code class="descname">name</code><em class="property"> = 'gaussian'</em><a class="headerlink" href="#pycbc.inference.likelihood.GaussianLikelihood.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.GaussianLikelihood.required_kwargs">
<code class="descname">required_kwargs</code><em class="property"> = ['waveform_generator', 'data', 'f_lower']</em><a class="headerlink" href="#pycbc.inference.likelihood.GaussianLikelihood.required_kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycbc.inference.likelihood.MarginalizedPhaseGaussianLikelihood">
<em class="property">class </em><code class="descclassname">pycbc.inference.likelihood.</code><code class="descname">MarginalizedPhaseGaussianLikelihood</code><span class="sig-paren">(</span><em>variable_args</em>, <em>waveform_generator=None</em>, <em>data=None</em>, <em>f_lower=None</em>, <em>psds=None</em>, <em>f_upper=None</em>, <em>norm=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#MarginalizedPhaseGaussianLikelihood"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.MarginalizedPhaseGaussianLikelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.likelihood.GaussianLikelihood" title="pycbc.inference.likelihood.GaussianLikelihood"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.likelihood.GaussianLikelihood</span></code></a></p>
<p>The likelihood is analytically marginalized over phase.</p>
<p>This class can be used with signal models that can be written as:</p>
<div class="math notranslate nohighlight">
\[\tilde{h}(f; \Theta, \phi) = A(f; \Theta)e^{i\Psi(f; \Theta) + i \phi},\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> is an arbitrary phase constant. This phase constant
can be analytically marginalized over with a uniform prior as follows:
assuming the noise is stationary and Gaussian (see <cite>GaussianLikelihood</cite>
for details), the posterior is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\Theta,\phi|d) &amp;\propto p(\Theta)p(\phi)p(d|\Theta,\phi) \\
                 &amp;\propto p(\Theta)\frac{1}{2\pi}\exp\left[-\frac{1}{2}\sum_{i}^{N_D} \left&lt;h_i(\Theta,\phi) - d_i, h_i(\Theta,\phi) - d_i\right&gt;\right].\end{split}\]</div>
<p>Here, the sum is over the number of detectors <span class="math notranslate nohighlight">\(N_D\)</span>, <span class="math notranslate nohighlight">\(d_i\)</span>
and <span class="math notranslate nohighlight">\(h_i\)</span> are the data and signal in the <span class="math notranslate nohighlight">\(i`th detector,
respectively, and we have assumed a uniform prior on :math:`phi \in [0,
2\pi)\)</span>. With the form of the signal model given above, the inner product
in the exponent can be written as:</p>
<div class="math notranslate nohighlight">
\[\]</div>
<p>-frac{1}{2}left&lt;h_i - d_i, h_i- d_iright&gt; &amp;= left&lt;h_i, d_iright&gt; - frac{1}{2}left&lt;h_i, h_iright&gt; - frac{1}{2}left&lt;d_i, d_iright&gt; \
&amp;= Releft{O(h^0_i, d_i)e^{-iphi}right} - frac{1}{2}left&lt;h^0_i, h^0_iright&gt; - frac{1}{2}left&lt;d_i, d_iright&gt;,</p>
<p>where:</p>
<div class="math notranslate nohighlight">
\[\begin{split}h_i^0 &amp;\equiv \tilde{h}_i(f; \Theta, \phi=0); \\
O(h^0_i, d_i) &amp;\equiv 4 \int_0^\infty \frac{\tilde{h}_i^*(f; \Theta,0) \tilde{d}_i(f)}{S_n(f)}\mathrm{d}f.\end{split}\]</div>
<p>Gathering all of the terms that are not dependent on <span class="math notranslate nohighlight">\(\phi\)</span> together:</p>
<div class="math notranslate nohighlight">
\[\alpha(\Theta, d) \equiv \exp\left[-\frac{1}{2}\sum_i \left&lt;h^0_i, h^0_i\right&gt; + &lt;d_i, d_i\right&gt;\right],\]</div>
<p>we can marginalize the posterior over <span class="math notranslate nohighlight">\(\phi\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(\Theta|d) &amp;\propto p(\Theta)\alpha(\Theta,d)\frac{1}{2\pi}\int_{0}^{2\pi}\exp\left[\Re \left\{ e^{-i\phi} \sum_i O(h^0_i, d_i)\right\}\right]\mathrm{d}\phi \\
&amp;\propto p(\Theta)\alpha(\Theta, d)\frac{1}{2\pi} \int_{0}^{2\pi}\exp\left[x(\Theta,d)\cos(\phi) + y(\Theta, d)\sin(\phi)\right]\mathrm{d}\phi.\end{split}\]</div>
<p>The integral in the last line is equal to <span class="math notranslate nohighlight">\(2\pi I_0(\sqrt{x^2+y^2})\)</span>,
where <span class="math notranslate nohighlight">\(I_0\)</span> is the modified Bessel function of the first kind. Thus
the marginalized log posterior is:</p>
<div class="math notranslate nohighlight">
\[\log p(\Theta|d) \propto \log p(\Theta) + I_0\left(\left|\sum_i O(h^0_i, d_i)\right|\right) - \frac{1}{2}\sum_i\left[ \left&lt;h^0_i, h^0_i\right&gt; - \left&lt;d_i, d_i\right&gt; \right]\]</div>
<p>This class computes the above expression for the log likelihood.</p>
<dl class="method">
<dt id="pycbc.inference.likelihood.MarginalizedPhaseGaussianLikelihood.loglr">
<code class="descname">loglr</code><span class="sig-paren">(</span><em>**params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/likelihood.html#MarginalizedPhaseGaussianLikelihood.loglr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.likelihood.MarginalizedPhaseGaussianLikelihood.loglr" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the log likelihood ratio,</p>
<div class="math notranslate nohighlight">
\[\log \mathcal{L}(\Theta) = I_0\left(\left|\sum_i O(h^0_i, d_i)\right|\right) - \frac{1}{2}\left&lt;h^0_i, h^0_i\right&gt;,\]</div>
<p>at the given point in parameter space <span class="math notranslate nohighlight">\(\Theta\)</span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>**params</strong> – The keyword arguments should give the values of each parameter to
evaluate.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The value of the log likelihood ratio evaluated at the given point.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">numpy.float64</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.likelihood.MarginalizedPhaseGaussianLikelihood.name">
<code class="descname">name</code><em class="property"> = 'marginalized_phase'</em><a class="headerlink" href="#pycbc.inference.likelihood.MarginalizedPhaseGaussianLikelihood.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pycbc.inference.option_utils">
<span id="pycbc-inference-option-utils-module"></span><h2>pycbc.inference.option_utils module<a class="headerlink" href="#module-pycbc.inference.option_utils" title="Permalink to this headline">¶</a></h2>
<p>This module contains standard options used for inference-related programs.</p>
<dl class="function">
<dt id="pycbc.inference.option_utils.add_density_option_group">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">add_density_option_group</code><span class="sig-paren">(</span><em>parser</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#add_density_option_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.add_density_option_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the options needed to configure contours and density colour map.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parser</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><em>object</em></a>) – ArgumentParser instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.add_inference_results_option_group">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">add_inference_results_option_group</code><span class="sig-paren">(</span><em>parser</em>, <em>include_parameters_group=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#add_inference_results_option_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.add_inference_results_option_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the options used to call pycbc.inference.results_from_cli function
to an argument parser. These are options releated to loading the results
from a run of pycbc_inference, for purposes of plotting and/or creating
tables.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>parser</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><em>object</em></a>) – ArgumentParser instance.</li>
<li><strong>include_parameters_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If true then include <cite>–parameters-group</cite> option.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.add_low_frequency_cutoff_opt">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">add_low_frequency_cutoff_opt</code><span class="sig-paren">(</span><em>parser</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#add_low_frequency_cutoff_opt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.add_low_frequency_cutoff_opt" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the low-frequency-cutoff option to the given parser.</p>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.add_plot_posterior_option_group">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">add_plot_posterior_option_group</code><span class="sig-paren">(</span><em>parser</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#add_plot_posterior_option_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.add_plot_posterior_option_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the options needed to configure plots of posterior results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parser</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><em>object</em></a>) – ArgumentParser instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.add_sampler_option_group">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">add_sampler_option_group</code><span class="sig-paren">(</span><em>parser</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#add_sampler_option_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.add_sampler_option_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the options needed to set up an inference sampler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parser</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><em>object</em></a>) – ArgumentParser instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.add_scatter_option_group">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">add_scatter_option_group</code><span class="sig-paren">(</span><em>parser</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#add_scatter_option_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.add_scatter_option_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the options needed to configure scatter plots.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parser</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><em>object</em></a>) – ArgumentParser instance.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.data_from_cli">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">data_from_cli</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#data_from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.data_from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the data needed for a likelihood evaluator from the given
command-line options. Gates specifed on the command line are also applied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opts</strong> (<em>ArgumentParser parsed args</em>) – Argument options parsed from a command line string (the sort of thing
returned by <cite>parser.parse_args</cite>).</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>strain_dict</strong> (<em>dict</em>) – Dictionary of instruments -&gt; <cite>TimeSeries</cite> strain.</li>
<li><strong>stilde_dict</strong> (<em>dict</em>) – Dictionary of instruments -&gt; <cite>FrequencySeries</cite> strain.</li>
<li><strong>psd_dict</strong> (<em>dict</em>) – Dictionary of instruments -&gt; <cite>FrequencySeries</cite> psds.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.expected_parameters_from_cli">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">expected_parameters_from_cli</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#expected_parameters_from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.expected_parameters_from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the –expected-parameters arguments from the <cite>plot_posterior</cite>
option group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opts</strong> (<em>ArgumentParser</em>) – The parsed arguments from the command line.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Dictionary of parameter name -&gt; expected value. Only parameters that
were specified in the –expected-parameters option will be included; if
no parameters were provided, will return an empty dictionary.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)">dict</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.get_file_type">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">get_file_type</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#get_file_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.get_file_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns I/O object to use for file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of file.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>file_type</strong> – The type of inference file object to use.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">{InferenceFile, InferenceTXTFile}</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.get_zvalues">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">get_zvalues</code><span class="sig-paren">(</span><em>fp</em>, <em>arg</em>, <em>likelihood_stats</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#get_zvalues"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.get_zvalues" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the data for the z-value of the plots from the inference file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open inference file; needed to get the value of the log noise
likelihood.</li>
<li><strong>arg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – The argument to plot; must be one of <cite>loglr</cite>, <cite>snr</cite>, <cite>logplr</cite>,
<cite>logposterior</cite>, or <cite>prior</cite>. If not one of these, a ValueError is
raised.</li>
<li><strong>likelihood_stats</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray"><em>FieldArray</em></a>) – The likelihood stats; the sort of thing returned by
<cite>fp.read_likelihood_stats</cite>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>zvals</strong> (<em>numpy.array</em>) – An array of the desired likelihood values to plot.</li>
<li><strong>zlbl</strong> (<em>str</em>) – The label to use for the values on a plot.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.injections_from_cli">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">injections_from_cli</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#injections_from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.injections_from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets injection parameters from the inference file(s).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opts</strong> (<em>argparser</em>) – Argparser object that has the command-line objects to parse.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Array of the injection parameters from all of the input files given
by <code class="docutils literal notranslate"><span class="pre">opts.input_file</span></code>.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray">FieldArray</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.low_frequency_cutoff_from_cli">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">low_frequency_cutoff_from_cli</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#low_frequency_cutoff_from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.low_frequency_cutoff_from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the low frequency cutoff from the given options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dictionary of instruments -&gt; low frequency cutoff.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)">dict</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.parse_parameters_opt">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">parse_parameters_opt</code><span class="sig-paren">(</span><em>parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#parse_parameters_opt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.parse_parameters_opt" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the –parameters opt in the results_reading_group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>parameters</strong> (<em>list of str</em><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.7)"><em>None</em></a>) – The parameters to parse.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>parameters</strong> (<em>list of str</em>) – The parameters.</li>
<li><strong>labels</strong> (<em>dict</em>) – A dictionary mapping parameters for which labels were provide to those
labels.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.plot_ranges_from_cli">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">plot_ranges_from_cli</code><span class="sig-paren">(</span><em>opts</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#plot_ranges_from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.plot_ranges_from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the mins and maxs arguments from the <cite>plot_posterior</cite> option
group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>opts</strong> (<em>ArgumentParser</em>) – The parsed arguments from the command line.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>mins</strong> (<em>dict</em>) – Dictionary of parameter name -&gt; specified mins. Only parameters that
were specified in the –mins option will be included; if no parameters
were provided, will return an empty dictionary.</li>
<li><strong>maxs</strong> (<em>dict</em>) – Dictionary of parameter name -&gt; specified maxs. Only parameters that
were specified in the –mins option will be included; if no parameters
were provided, will return an empty dictionary.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.read_sampling_args_from_config">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">read_sampling_args_from_config</code><span class="sig-paren">(</span><em>cp</em>, <em>section_group=None</em>, <em>section='sampling_parameters'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#read_sampling_args_from_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.read_sampling_args_from_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads sampling parameters from the given config file.</p>
<p>Parameters are read from the <cite>[({section_group}_){section}]</cite> section.
The options should list the variable args to transform; the parameters they
point to should list the parameters they are to be transformed to for
sampling. If a multiple parameters are transformed together, they should
be comma separated. Example:</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[sampling_parameters]</span>
<span class="na">mass1, mass2</span> <span class="o">=</span> <span class="s">mchirp, logitq</span>
<span class="na">spin1_a</span> <span class="o">=</span> <span class="s">logitspin1_a</span>
</pre></div>
</div>
<p>Note that only the final sampling parameters should be listed, even if
multiple intermediate transforms are needed. (In the above example, a
transform is needed to go from mass1, mass2 to mchirp, q, then another one
needed to go from q to logitq.) These transforms should be specified
in separate sections; see <cite>transforms.read_transforms_from_config</cite> for
details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cp</strong> (<a class="reference internal" href="pycbc.workflow.html#pycbc.workflow.configuration.WorkflowConfigParser" title="pycbc.workflow.configuration.WorkflowConfigParser"><em>WorkflowConfigParser</em></a>) – An open config parser to read from.</li>
<li><strong>section_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – Append <cite>{section_group}_</cite> to the section name. Default is None.</li>
<li><strong>section</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the section. Default is ‘sampling_parameters’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>sampling_params</strong> (<em>list</em>) – The list of sampling parameters to use instead.</li>
<li><strong>replaced_params</strong> (<em>list</em>) – The list of variable args to replace in the sampler.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.results_from_cli">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">results_from_cli</code><span class="sig-paren">(</span><em>opts</em>, <em>load_samples=True</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#results_from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.results_from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads an inference result file along with any labels associated with it
from the command line options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>opts</strong> (<em>ArgumentParser options</em>) – The options from the command line.</li>
<li><strong>load_samples</strong> (<em>{True</em><em>, </em><em>bool}</em>) – Load samples from the results file using the parameters, thin_start,
and thin_interval specified in the options. The samples are returned
as a FieldArray instance.</li>
<li><strong>**kwargs</strong> – All other keyword arguments are passed to the InferenceFile’s
read_samples function.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>fp_all</strong> (<em>pycbc.io.InferenceFile</em>) – The result file as an InferenceFile. If more than one input file,
then it returns a list.</li>
<li><strong>parameters_all</strong> (<em>list</em>) – List of the parameters to use, parsed from the parameters option.
If more than one input file, then it returns a list.</li>
<li><strong>labels_all</strong> (<em>list</em>) – List of labels to associate with the parameters. If more than one
input file, then it returns a list.</li>
<li><strong>samples_all</strong> (<em>{None, FieldArray}</em>) – If load_samples, the samples as a FieldArray; otherwise, None.
If more than one input file, then it returns a list.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.sampler_from_cli">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">sampler_from_cli</code><span class="sig-paren">(</span><em>opts</em>, <em>likelihood_evaluator</em>, <em>pool=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#sampler_from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.sampler_from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses the given command-line options to set up a sampler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>opts</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.7)"><em>object</em></a>) – ArgumentParser options.</li>
<li><strong>likelihood_evaluator</strong> (<em>LikelihoodEvaluator</em>) – The likelihood evaluator to use with the sampler.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A sampler initialized based on the given arguments.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pycbc.inference.sampler</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pycbc.inference.option_utils.validate_checkpoint_files">
<code class="descclassname">pycbc.inference.option_utils.</code><code class="descname">validate_checkpoint_files</code><span class="sig-paren">(</span><em>checkpoint_file</em>, <em>backup_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/option_utils.html#validate_checkpoint_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.option_utils.validate_checkpoint_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the given checkpoint and/or backup files are valid.</p>
<p>The checkpoint file is considered valid if:</p>
<blockquote>
<div><ul class="simple">
<li>it passes all tests run by <code class="docutils literal notranslate"><span class="pre">InferenceFile.check_integrity</span></code>;</li>
<li>it has at least one sample written to it (indicating at least one
checkpoint has happened).</li>
</ul>
</div></blockquote>
<p>The same applies to the backup file. The backup file must also have the
same number of samples as the checkpoint file, otherwise, the backup is
considered invalid.</p>
<p>If the checkpoint (backup) file is found to be valid, but the backup
(checkpoint) file is not valid, then the checkpoint (backup) is copied to
the backup (checkpoint). Thus, this function ensures that checkpoint and
backup files are either both valid or both invalid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>checkpoint_file</strong> (<em>string</em>) – Name of the checkpoint file.</li>
<li><strong>backup_file</strong> (<em>string</em>) – Name of the backup file.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>checkpoint_valid</strong> – Whether or not the checkpoint (and backup) file may be used for loading
samples.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)">bool</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-pycbc.inference.sampler">
<span id="pycbc-inference-sampler-module"></span><h2>pycbc.inference.sampler module<a class="headerlink" href="#module-pycbc.inference.sampler" title="Permalink to this headline">¶</a></h2>
<p>This modules provides a list of implemented samplers for parameter estimation.</p>
</div>
<div class="section" id="module-pycbc.inference.sampler_base">
<span id="pycbc-inference-sampler-base-module"></span><h2>pycbc.inference.sampler_base module<a class="headerlink" href="#module-pycbc.inference.sampler_base" title="Permalink to this headline">¶</a></h2>
<p>This modules provides classes and functions for using different sampler
packages for parameter estimation.</p>
<dl class="class">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler">
<em class="property">class </em><code class="descclassname">pycbc.inference.sampler_base.</code><code class="descname">BaseMCMCSampler</code><span class="sig-paren">(</span><em>sampler</em>, <em>likelihood_evaluator</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.sampler_base._BaseSampler</span></code></p>
<p>This class is used to construct the MCMC sampler from the kombine-like
packages.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>sampler</strong> (<em>sampler instance</em>) – An instance of an MCMC sampler similar to kombine or emcee.</li>
<li><strong>likelihood_evaluator</strong> (<em>likelihood class</em>) – An instance of the likelihood class from the
pycbc.inference.likelihood module.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.sampler">
<code class="descname">sampler</code><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>The MCMC sampler instance used.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.p0">
<code class="descname">p0</code><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.p0" title="Permalink to this definition">¶</a></dt>
<dd><p><em>nwalkers x ndim array</em> – The initial position of the walkers. Set by using set_p0. If not set
yet, a ValueError is raised when the attribute is accessed.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.pos">
<code class="descname">pos</code><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.pos" title="Permalink to this definition">¶</a></dt>
<dd><p><em>{None, array}</em> – An array of the current walker positions.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.acceptance_fraction">
<code class="descname">acceptance_fraction</code><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the fraction of steps accepted by each walker as an array.</p>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.compute_acfs">
<em class="property">classmethod </em><code class="descname">compute_acfs</code><span class="sig-paren">(</span><em>fp</em>, <em>start_index=None</em>, <em>end_index=None</em>, <em>per_walker=False</em>, <em>walkers=None</em>, <em>parameters=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.compute_acfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.compute_acfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the autocorrleation function of the variable args in the
given file.</p>
<p>By default, parameter values are averaged over all walkers at each
iteration. The ACF is then calculated over the averaged chain. An
ACF per-walker will be returned instead if <code class="docutils literal notranslate"><span class="pre">per_walker=True</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open file handler to read the samples from.</li>
<li><strong>start_index</strong> (<em>{None</em><em>, </em><em>int}</em>) – The start index to compute the acl from. If None, will try to use
the number of burn-in iterations in the file; otherwise, will start
at the first sample.</li>
<li><strong>end_index</strong> (<em>{None</em><em>, </em><em>int}</em>) – The end index to compute the acl to. If None, will go to the end
of the current iteration.</li>
<li><strong>per_walker</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Return the ACF for each walker separately. Default is False.</li>
<li><strong>walkers</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>array</em>) – Calculate the ACF using only the given walkers. If None (the
default) all walkers will be used.</li>
<li><strong>parameters</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>array</em>) – Calculate the ACF for only the given parameters. If None (the
default) will calculate the ACF for all of the variable args.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A <code class="docutils literal notranslate"><span class="pre">FieldArray</span></code> of the ACF vs iteration for each parameter. If
<cite>per-walker</cite> is True, the FieldArray will have shape
<code class="docutils literal notranslate"><span class="pre">nwalkers</span> <span class="pre">x</span> <span class="pre">niterations</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray">FieldArray</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.compute_acls">
<em class="property">classmethod </em><code class="descname">compute_acls</code><span class="sig-paren">(</span><em>fp</em>, <em>start_index=None</em>, <em>end_index=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.compute_acls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.compute_acls" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the autocorrleation length for all variable args in the
given file.</p>
<p>Parameter values are averaged over all walkers at each iteration.
The ACL is then calculated over the averaged chain. If the returned ACL
is <cite>inf</cite>,  will default to the number of current iterations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open file handler to read the samples from.</li>
<li><strong>start_index</strong> (<em>{None</em><em>, </em><em>int}</em>) – The start index to compute the acl from. If None, will try to use
the number of burn-in iterations in the file; otherwise, will start
at the first sample.</li>
<li><strong>end_index</strong> (<em>{None</em><em>, </em><em>int}</em>) – The end index to compute the acl to. If None, will go to the end
of the current iteration.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A dictionary giving the ACL for each parameter.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)">dict</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.likelihood_stats">
<code class="descname">likelihood_stats</code><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.likelihood_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the likelihood stats as a FieldArray, with field names
corresponding to the type of data returned by the likelihood evaluator.
The returned array has shape nwalkers x niterations. If no additional
stats were returned to the sampler by the likelihood evaluator, returns
None.</p>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.n_independent_samples">
<em class="property">classmethod </em><code class="descname">n_independent_samples</code><span class="sig-paren">(</span><em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.n_independent_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.n_independent_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the number of independent samples stored in a file.</p>
<p>The number of independent samples are counted starting from after
burn-in. If the sampler hasn’t burned in yet, then 0 is returned.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open file handler to read.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">The number of independent samples.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)">int</a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.name">
<code class="descname">name</code><em class="property"> = None</em><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.nwalkers">
<code class="descname">nwalkers</code><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.nwalkers" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of walkers.</p>
</dd></dl>

<dl class="attribute">
<dt>
<code class="descname">p0</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">pos</code></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.read_acceptance_fraction">
<em class="property">static </em><code class="descname">read_acceptance_fraction</code><span class="sig-paren">(</span><em>fp</em>, <em>walkers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.read_acceptance_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.read_acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the acceptance fraction from the given file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open file handler to read the samples from.</li>
<li><strong>walkers</strong> (<em>{None</em><em>, </em><em>(</em><em>list of</em><em>) </em><em>int}</em>) – The walker index (or a list of indices) to retrieve. If None,
samples from all walkers will be obtained.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Array of acceptance fractions with shape (requested walkers,).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.read_acls">
<em class="property">static </em><code class="descname">read_acls</code><span class="sig-paren">(</span><em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.read_acls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.read_acls" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.read_samples">
<em class="property">classmethod </em><code class="descname">read_samples</code><span class="sig-paren">(</span><em>fp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.read_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.read_samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt>
<code class="descname">sampler</code></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.samples">
<code class="descname">samples</code><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the samples in the chain as a FieldArray.</p>
<p>If the sampling args are not the same as the variable args, the
returned samples will have both the sampling and the variable args.</p>
<p>The returned FieldArray has dimension [additional dimensions x]
nwalkers x niterations.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.set_p0">
<code class="descname">set_p0</code><span class="sig-paren">(</span><em>samples_file=None</em>, <em>prior=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.set_p0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.set_p0" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the initial position of the walkers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples_file</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a><em>, </em><em>optional</em>) – If provided, use the last iteration in the given file for the
starting positions.</li>
<li><strong>prior</strong> (<a class="reference internal" href="pycbc.distributions.html#pycbc.distributions.joint.JointDistribution" title="pycbc.distributions.joint.JointDistribution"><em>JointDistribution</em></a><em>, </em><em>optional</em>) – Use the given prior to set the initial positions rather than
<cite>likelihood_evaultor</cite>’s prior.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>p0</strong> – An nwalkers x ndim array of the initial positions that were set.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.write_acceptance_fraction">
<code class="descname">write_acceptance_fraction</code><span class="sig-paren">(</span><em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.write_acceptance_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.write_acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Write acceptance_fraction data to file. Results are written to
<cite>fp[acceptance_fraction]</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.write_acls">
<em class="property">static </em><code class="descname">write_acls</code><span class="sig-paren">(</span><em>fp</em>, <em>acls</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.write_acls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.write_acls" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the given autocorrelation lengths to the given file.</p>
<p>The ACL of each parameter is saved to <code class="docutils literal notranslate"><span class="pre">fp['acls/{param}']</span></code>.
The maximum over all the parameters is saved to the file’s ‘acl’
attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open file handler to write the samples to.</li>
<li><strong>acls</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)"><em>dict</em></a>) – A dictionary of ACLs keyed by the parameter.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The maximum of the acls that was written to the file.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">ACL</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.write_chain">
<code class="descname">write_chain</code><span class="sig-paren">(</span><em>fp</em>, <em>start_iteration=None</em>, <em>max_iterations=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.write_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.write_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the samples from the current chain to the given file.</p>
<p>Results are written to:</p>
<blockquote>
<div><cite>fp[fp.samples_group/{field}/(temp{k}/)walker{i}]</cite>,</div></blockquote>
<p>where <cite>{i}</cite> is the index of a walker, <cite>{field}</cite> is the name of each
field returned by <cite>likelihood_stats</cite>, and, if the sampler is
multitempered, <cite>{k}</cite> is the temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</li>
<li><strong>start_iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Write results to the file’s datasets starting at the given
iteration. Default is to append after the last iteration in the
file.</li>
<li><strong>max_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Set the maximum size that the arrays in the hdf file may be resized
to. Only applies if the samples have not previously been written
to file. The default (None) is to use the maximum size allowed by
h5py.</li>
<li><strong>samples_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of samples group to write.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.write_likelihood_stats">
<code class="descname">write_likelihood_stats</code><span class="sig-paren">(</span><em>fp</em>, <em>start_iteration=None</em>, <em>max_iterations=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.write_likelihood_stats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.write_likelihood_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes the <cite>likelihood_stats</cite> to the given file.</p>
<p>Results are written to:</p>
<blockquote>
<div><cite>fp[fp.stats_group/{field}/(temp{k}/)walker{i}]</cite>,</div></blockquote>
<p>where <cite>{i}</cite> is the index of a walker, <cite>{field}</cite> is the name of each
field returned by <cite>likelihood_stats</cite>, and, if the sampler is
multitempered, <cite>{k}</cite> is the temperature.  If nothing is returned by
<cite>likelihood_stats</cite>, this does nothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</li>
<li><strong>start_iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Write results to the file’s datasets starting at the given
iteration. Default is to append after the last iteration in the
file.</li>
<li><strong>max_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Set the maximum size that the arrays in the hdf file may be resized
to. Only applies if the samples have not previously been written
to file. The default (None) is to use the maximum size allowed by
h5py.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>stats</strong> – The stats that were written, as a FieldArray. If there were no
stats, returns None.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">{FieldArray, None}</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.write_metadata">
<code class="descname">write_metadata</code><span class="sig-paren">(</span><em>fp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.write_metadata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.write_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes metadata about this sampler to the given file. Metadata is
written to the file’s <cite>attrs</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</li>
<li><strong>**kwargs</strong> – All keyword args are written to the file’s <code class="docutils literal notranslate"><span class="pre">attrs</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.write_results">
<code class="descname">write_results</code><span class="sig-paren">(</span><em>fp</em>, <em>start_iteration=None</em>, <em>max_iterations=None</em>, <em>**metadata</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.write_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.write_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes metadata, samples, likelihood stats, and acceptance fraction
to the given file. Also computes and writes the autocorrleation lengths
of the chains. See the various write function for details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</li>
<li><strong>start_iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Write results to the file’s datasets starting at the given
iteration. Default is to append after the last iteration in the
file.</li>
<li><strong>max_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Set the maximum size that the arrays in the hdf file may be resized
to. Only applies if the acceptance fraction has not previously been
written to the file. The default (None) is to use the maximum size
allowed by h5py.</li>
<li><strong>**metadata</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">write_metadata</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pycbc.inference.sampler_base.BaseMCMCSampler.write_samples_group">
<em class="property">static </em><code class="descname">write_samples_group</code><span class="sig-paren">(</span><em>fp</em>, <em>samples_group</em>, <em>parameters</em>, <em>samples</em>, <em>start_iteration=None</em>, <em>max_iterations=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_base.html#BaseMCMCSampler.write_samples_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_base.BaseMCMCSampler.write_samples_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes samples to the given file.</p>
<p>Results are written to:</p>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">fp[samples_group/{vararg}]</span></code>,</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">{vararg}</span></code> is the name of a variable arg. The samples are
written as an <code class="docutils literal notranslate"><span class="pre">nwalkers</span> <span class="pre">x</span> <span class="pre">niterations</span></code> array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</li>
<li><strong>samples_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of samples group to write.</li>
<li><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – The parameters to write to the file.</li>
<li><strong>samples</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray"><em>FieldArray</em></a>) – The samples to write. Should be a FieldArray with fields containing
the samples to write and shape nwalkers x niterations.</li>
<li><strong>start_iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Write results to the file’s datasets starting at the given
iteration. Default is to append after the last iteration in the
file.</li>
<li><strong>max_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Set the maximum size that the arrays in the hdf file may be resized
to. Only applies if the samples have not previously been written
to file. The default (None) is to use the maximum size allowed by
h5py.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pycbc.inference.sampler_emcee">
<span id="pycbc-inference-sampler-emcee-module"></span><h2>pycbc.inference.sampler_emcee module<a class="headerlink" href="#module-pycbc.inference.sampler_emcee" title="Permalink to this headline">¶</a></h2>
<p>This modules provides classes and functions for using the emcee sampler
packages for parameter estimation.</p>
<dl class="class">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler">
<em class="property">class </em><code class="descclassname">pycbc.inference.sampler_emcee.</code><code class="descname">EmceeEnsembleSampler</code><span class="sig-paren">(</span><em>likelihood_evaluator</em>, <em>nwalkers</em>, <em>pool=None</em>, <em>likelihood_call=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceeEnsembleSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.sampler_base.BaseMCMCSampler" title="pycbc.inference.sampler_base.BaseMCMCSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.sampler_base.BaseMCMCSampler</span></code></a></p>
<p>This class is used to construct an MCMC sampler from the emcee
package’s EnsembleSampler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>likelihood_evaluator</strong> (<em>likelihood class</em>) – An instance of the likelihood class from the
pycbc.inference.likelihood module.</li>
<li><strong>nwalkers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of walkers to use in sampler.</li>
<li><strong>pool</strong> (<em>function with map</em><em>, </em><em>Optional</em>) – A provider of a map function that allows a function call to be run
over multiple sets of arguments and possibly maps them to
cores/nodes/etc.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.chain">
<code class="descname">chain</code><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all past samples as an nwalker x niterations x ndim array.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.clear_chain">
<code class="descname">clear_chain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceeEnsembleSampler.clear_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.clear_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears the chain and blobs from memory.</p>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.from_cli">
<em class="property">classmethod </em><code class="descname">from_cli</code><span class="sig-paren">(</span><em>opts</em>, <em>likelihood_evaluator</em>, <em>pool=None</em>, <em>likelihood_call=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceeEnsembleSampler.from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance of this sampler from the given command-line
options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>opts</strong> (<em>ArgumentParser options</em>) – The options to parse.</li>
<li><strong>likelihood_evaluator</strong> (<em>LikelihoodEvaluator</em>) – The likelihood evaluator to use with the sampler.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An emcee sampler initialized based on the given arguments.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler" title="pycbc.inference.sampler_emcee.EmceeEnsembleSampler">EmceeEnsembleSampler</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.lnpost">
<code class="descname">lnpost</code><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.lnpost" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the natural logarithm of the likelihood as an
nwalkers x niterations array.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.name">
<code class="descname">name</code><em class="property"> = 'emcee'</em><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>niterations</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceeEnsembleSampler.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the ensemble for a number of samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>niterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of samples to get from sampler.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>p</strong> (<em>numpy.array</em>) – An array of current walker positions with shape (nwalkers, ndim).</li>
<li><strong>lnpost</strong> (<em>numpy.array</em>) – The list of log posterior probabilities for the walkers at
positions p, with shape (nwalkers, ndim).</li>
<li><em>rstate</em> – The current state of the random number generator.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.set_p0">
<code class="descname">set_p0</code><span class="sig-paren">(</span><em>samples_file=None</em>, <em>prior=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceeEnsembleSampler.set_p0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.set_p0" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the initial position of the walkers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples_file</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a><em>, </em><em>optional</em>) – If provided, use the last iteration in the given file for the
starting positions.</li>
<li><strong>prior</strong> (<a class="reference internal" href="pycbc.distributions.html#pycbc.distributions.joint.JointDistribution" title="pycbc.distributions.joint.JointDistribution"><em>JointDistribution</em></a><em>, </em><em>optional</em>) – Use the given prior to set the initial positions rather than
<cite>likelihood_evaultor</cite>’s prior.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>p0</strong> – An nwalkers x ndim array of the initial positions that were set.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.set_state_from_file">
<code class="descname">set_state_from_file</code><span class="sig-paren">(</span><em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceeEnsembleSampler.set_state_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.set_state_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the state of the sampler back to the instance saved in a file.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.write_results">
<code class="descname">write_results</code><span class="sig-paren">(</span><em>fp</em>, <em>start_iteration=None</em>, <em>max_iterations=None</em>, <em>**metadata</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceeEnsembleSampler.write_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.write_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes metadata, samples, likelihood stats, and acceptance fraction
to the given file. See the write function for each of those for
details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</li>
<li><strong>start_iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Write results to the file’s datasets starting at the given
iteration. Default is to append after the last iteration in the
file.</li>
<li><strong>max_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Set the maximum size that the arrays in the hdf file may be resized
to. Only applies if the samples have not previously been written
to file. The default (None) is to use the maximum size allowed by
h5py.</li>
<li><strong>**metadata</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">write_metadata</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceeEnsembleSampler.write_state">
<code class="descname">write_state</code><span class="sig-paren">(</span><em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceeEnsembleSampler.write_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceeEnsembleSampler.write_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the state of the sampler in a file.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler">
<em class="property">class </em><code class="descclassname">pycbc.inference.sampler_emcee.</code><code class="descname">EmceePTSampler</code><span class="sig-paren">(</span><em>likelihood_evaluator</em>, <em>ntemps</em>, <em>nwalkers</em>, <em>pool=None</em>, <em>likelihood_call=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.sampler_base.BaseMCMCSampler" title="pycbc.inference.sampler_base.BaseMCMCSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.sampler_base.BaseMCMCSampler</span></code></a></p>
<p>This class is used to construct a parallel-tempered MCMC sampler from
the emcee package’s PTSampler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>likelihood_evaluator</strong> (<em>likelihood class</em>) – An instance of the likelihood class from the
pycbc.inference.likelihood module.</li>
<li><strong>ntemps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of temeratures to use in the sampler.</li>
<li><strong>nwalkers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of walkers to use in sampler.</li>
<li><strong>pool</strong> (<em>function with map</em><em>, </em><em>Optional</em>) – A provider of a map function that allows a function call to be run
over multiple sets of arguments and possibly maps them to
cores/nodes/etc.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="classmethod">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.calculate_logevidence">
<em class="property">classmethod </em><code class="descname">calculate_logevidence</code><span class="sig-paren">(</span><em>fp</em>, <em>thin_start=None</em>, <em>thin_end=None</em>, <em>thin_interval=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.calculate_logevidence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.calculate_logevidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the log evidence from the given file using emcee’s
thermodynamic integration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open file handler to read the stats from.</li>
<li><strong>thin_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of the sample to begin returning stats. Default is to read
stats after burn in. To start from the beginning set thin_start
to 0.</li>
<li><strong>thin_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Interval to accept every i-th sample. Default is to use the
<cite>fp.acl</cite>. If <cite>fp.acl</cite> is not set, then use all stats
(set thin_interval to 1).</li>
<li><strong>thin_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Index of the last sample to read. If not given then
<cite>fp.niterations</cite> is used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>lnZ</strong> (<em>float</em>) – The estimate of log of the evidence.</li>
<li><strong>dlnZ</strong> (<em>float</em>) – The error on the estimate.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.chain">
<code class="descname">chain</code><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all past samples as an ntemps x nwalker x niterations x ndim
array.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.clear_chain">
<code class="descname">clear_chain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.clear_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.clear_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears the chain and blobs from memory.</p>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.compute_acfs">
<em class="property">classmethod </em><code class="descname">compute_acfs</code><span class="sig-paren">(</span><em>fp</em>, <em>start_index=None</em>, <em>end_index=None</em>, <em>per_walker=False</em>, <em>walkers=None</em>, <em>parameters=None</em>, <em>temps=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.compute_acfs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.compute_acfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the autocorrleation function of the variable args in the
given file.</p>
<p>By default, parameter values are averaged over all walkers at each
iteration. The ACF is then calculated over the averaged chain for each
temperature. An ACF per-walker will be returned instead if
<code class="docutils literal notranslate"><span class="pre">per_walker=True</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open file handler to read the samples from.</li>
<li><strong>start_index</strong> (<em>{None</em><em>, </em><em>int}</em>) – The start index to compute the acl from. If None, will try to use
the number of burn-in iterations in the file; otherwise, will start
at the first sample.</li>
<li><strong>end_index</strong> (<em>{None</em><em>, </em><em>int}</em>) – The end index to compute the acl to. If None, will go to the end
of the current iteration.</li>
<li><strong>per_walker</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – Return the ACF for each walker separately. Default is False.</li>
<li><strong>walkers</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>array</em>) – Calculate the ACF using only the given walkers. If None (the
default) all walkers will be used.</li>
<li><strong>parameters</strong> (<em>optional</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a><em> or </em><em>array</em>) – Calculate the ACF for only the given parameters. If None (the
default) will calculate the ACF for all of the variable args.</li>
<li><strong>temps</strong> (<em>optional</em><em>, </em><em>(</em><em>list of</em><em>) </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>'all'</em>) – The temperature index (or list of indices) to retrieve. If None
(the default), the ACF will only be computed for the coldest (= 0)
temperature chain. To compute an ACF for all temperates pass ‘all’,
or a list of all of the temperatures.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A <code class="docutils literal notranslate"><span class="pre">FieldArray</span></code> of the ACF vs iteration for each parameter. If
<cite>per-walker</cite> is True, the FieldArray will have shape
<code class="docutils literal notranslate"><span class="pre">ntemps</span> <span class="pre">x</span> <span class="pre">nwalkers</span> <span class="pre">x</span> <span class="pre">niterations</span></code>. Otherwise, the returned
array will have shape <code class="docutils literal notranslate"><span class="pre">ntemps</span> <span class="pre">x</span> <span class="pre">niterations</span></code>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray">FieldArray</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.compute_acls">
<em class="property">classmethod </em><code class="descname">compute_acls</code><span class="sig-paren">(</span><em>fp</em>, <em>start_index=None</em>, <em>end_index=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.compute_acls"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.compute_acls" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the autocorrleation length for all variable args and
temperatures in the given file.</p>
<p>Parameter values are averaged over all walkers at each iteration and
temperature.  The ACL is then calculated over the averaged chain. If
the returned ACL is <cite>inf</cite>,  will default to the number of current
iterations.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open file handler to read the samples from.</li>
<li><strong>start_index</strong> (<em>{None</em><em>, </em><em>int}</em>) – The start index to compute the acl from. If None, will try to use
the number of burn-in iterations in the file; otherwise, will start
at the first sample.</li>
<li><strong>end_index</strong> (<em>{None</em><em>, </em><em>int}</em>) – The end index to compute the acl to. If None, will go to the end
of the current iteration.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A dictionary of ntemps-long arrays of the ACLs of each parameter.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.7)">dict</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.from_cli">
<em class="property">classmethod </em><code class="descname">from_cli</code><span class="sig-paren">(</span><em>opts</em>, <em>likelihood_evaluator</em>, <em>pool=None</em>, <em>likelihood_call=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance of this sampler from the given command-line
options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>opts</strong> (<em>ArgumentParser options</em>) – The options to parse.</li>
<li><strong>likelihood_evaluator</strong> (<em>LikelihoodEvaluator</em>) – The likelihood evaluator to use with the sampler.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">An emcee sampler initialized based on the given arguments.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pycbc.inference.sampler_emcee.EmceePTSampler" title="pycbc.inference.sampler_emcee.EmceePTSampler">EmceePTSampler</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.likelihood_stats">
<code class="descname">likelihood_stats</code><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.likelihood_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log likelihood ratio and log prior as a FieldArray.
The returned array has shape ntemps x nwalkers x niterations.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.lnpost">
<code class="descname">lnpost</code><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.lnpost" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the natural logarithm of the likelihood + the prior as an
ntemps x nwalkers x niterations array.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.name">
<code class="descname">name</code><em class="property"> = 'emcee_pt'</em><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.ntemps">
<code class="descname">ntemps</code><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.ntemps" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.read_acceptance_fraction">
<em class="property">static </em><code class="descname">read_acceptance_fraction</code><span class="sig-paren">(</span><em>fp</em>, <em>temps=None</em>, <em>walkers=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.read_acceptance_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.read_acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the acceptance fraction from the given file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – An open file handler to read the samples from.</li>
<li><strong>temps</strong> (<em>{None</em><em>, </em><em>(</em><em>list of</em><em>) </em><em>int}</em>) – The temperature index (or a list of indices) to retrieve. If None,
acfs from all temperatures and all walkers will be retrieved.</li>
<li><strong>walkers</strong> (<em>{None</em><em>, </em><em>(</em><em>list of</em><em>) </em><em>int}</em>) – The walker index (or a list of indices) to retrieve. If None,
samples from all walkers will be obtained.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Array of acceptance fractions with shape (requested temps,
requested walkers).</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.read_samples">
<em class="property">classmethod </em><code class="descname">read_samples</code><span class="sig-paren">(</span><em>fp</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.read_samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>niterations</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the ensemble for a number of samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>niterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of samples to get from sampler.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>p</strong> (<em>numpy.array</em>) – An array of current walker positions with shape (nwalkers, ndim).</li>
<li><strong>lnpost</strong> (<em>numpy.array</em>) – The list of log posterior probabilities for the walkers at
positions p, with shape (nwalkers, ndim).</li>
<li><em>rstate</em> – The current state of the random number generator.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.set_p0">
<code class="descname">set_p0</code><span class="sig-paren">(</span><em>samples_file=None</em>, <em>prior=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.set_p0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.set_p0" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the initial position of the walkers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>samples_file</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a><em>, </em><em>optional</em>) – If provided, use the last iteration in the given file for the
starting positions.</li>
<li><strong>prior</strong> (<a class="reference internal" href="pycbc.distributions.html#pycbc.distributions.joint.JointDistribution" title="pycbc.distributions.joint.JointDistribution"><em>JointDistribution</em></a><em>, </em><em>optional</em>) – Use the given prior to set the initial positions rather than
<cite>likelihood_evaultor</cite>’s prior.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>p0</strong> – An ntemps x nwalkers x ndim array of the initial positions that
were set.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.write_acceptance_fraction">
<code class="descname">write_acceptance_fraction</code><span class="sig-paren">(</span><em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.write_acceptance_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.write_acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Write acceptance_fraction data to file. Results are written to
<cite>fp[acceptance_fraction/temp{k}]</cite> where k is the temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.write_metadata">
<code class="descname">write_metadata</code><span class="sig-paren">(</span><em>fp</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.write_metadata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.write_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes metadata about this sampler to the given file. Metadata is
written to the file’s <cite>attrs</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</li>
<li><strong>**kwargs</strong> – All keyword arguments are saved as separate arguments in the
file attrs. If any keyword argument is a dictionary, the keyword
will point to the list of keys in the the file’s <code class="docutils literal notranslate"><span class="pre">attrs</span></code>. Each
key is then stored as a separate attr with its corresponding value.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.write_results">
<code class="descname">write_results</code><span class="sig-paren">(</span><em>fp</em>, <em>start_iteration=None</em>, <em>max_iterations=None</em>, <em>**metadata</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.write_results"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.write_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes metadata, samples, likelihood stats, and acceptance fraction
to the given file. See the write function for each of those for
details.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</li>
<li><strong>start_iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Write results to the file’s datasets starting at the given
iteration. Default is to append after the last iteration in the
file.</li>
<li><strong>max_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Set the maximum size that the arrays in the hdf file may be resized
to. Only applies if the samples have not previously been written
to file. The default (None) is to use the maximum size allowed by
h5py.</li>
<li><strong>**metadata</strong> – All other keyword arguments are passed to <code class="docutils literal notranslate"><span class="pre">write_metadata</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="staticmethod">
<dt id="pycbc.inference.sampler_emcee.EmceePTSampler.write_samples_group">
<em class="property">static </em><code class="descname">write_samples_group</code><span class="sig-paren">(</span><em>fp</em>, <em>samples_group</em>, <em>parameters</em>, <em>samples</em>, <em>start_iteration=None</em>, <em>max_iterations=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_emcee.html#EmceePTSampler.write_samples_group"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_emcee.EmceePTSampler.write_samples_group" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes samples to the given file.</p>
<p>Results are written to:</p>
<blockquote>
<div><code class="docutils literal notranslate"><span class="pre">fp[samples_group/{vararg}]</span></code>,</div></blockquote>
<p>where <code class="docutils literal notranslate"><span class="pre">{vararg}</span></code> is the name of a variable arg. The samples are
written as an <code class="docutils literal notranslate"><span class="pre">ntemps</span> <span class="pre">x</span> <span class="pre">nwalkers</span> <span class="pre">x</span> <span class="pre">niterations</span></code> array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</li>
<li><strong>samples_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.7)"><em>str</em></a>) – Name of samples group to write.</li>
<li><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.7)"><em>list</em></a>) – The parameters to write to the file.</li>
<li><strong>samples</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.record.FieldArray" title="pycbc.io.record.FieldArray"><em>FieldArray</em></a>) – The samples to write. Should be a FieldArray with fields containing
the samples to write and shape nwalkers x niterations.</li>
<li><strong>start_iteration</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Write results to the file’s datasets starting at the given
iteration. Default is to append after the last iteration in the
file.</li>
<li><strong>max_iterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – Set the maximum size that the arrays in the hdf file may be resized
to. Only applies if the samples have not previously been written
to file. The default (None) is to use the maximum size allowed by
h5py.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pycbc.inference.sampler_kombine">
<span id="pycbc-inference-sampler-kombine-module"></span><h2>pycbc.inference.sampler_kombine module<a class="headerlink" href="#module-pycbc.inference.sampler_kombine" title="Permalink to this headline">¶</a></h2>
<p>This modules provides classes and functions for using the kombine sampler
packages for parameter estimation.</p>
<dl class="class">
<dt id="pycbc.inference.sampler_kombine.KombineSampler">
<em class="property">class </em><code class="descclassname">pycbc.inference.sampler_kombine.</code><code class="descname">KombineSampler</code><span class="sig-paren">(</span><em>likelihood_evaluator</em>, <em>nwalkers</em>, <em>transd=False</em>, <em>pool=None</em>, <em>likelihood_call=None</em>, <em>update_interval=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_kombine.html#KombineSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.sampler_base.BaseMCMCSampler" title="pycbc.inference.sampler_base.BaseMCMCSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.sampler_base.BaseMCMCSampler</span></code></a></p>
<p>This class is used to construct the MCMC sampler from the kombine
package.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>likelihood_evaluator</strong> (<em>likelihood class</em>) – An instance of the likelihood class from the
pycbc.inference.likelihood module.</li>
<li><strong>nwalkers</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of walkers to use in sampler.</li>
<li><strong>transd</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – If True, the sampler will operate across parameter spaces using a
kombine.clustered_kde.TransdimensionalKDE proposal distribution. In
this mode a masked array with samples in each of the possible sets of
dimensions must be given for the initial ensemble distribution.</li>
<li><strong>processes</strong> (<em>{None</em><em>, </em><em>int}</em>) – Number of processes to use with multiprocessing. If None, all available
cores are used.</li>
<li><strong>update_interval</strong> (<em>{None</em><em>, </em><em>int}</em>) – Make the sampler update the proposal densities every <cite>update_interval</cite>
iterations.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.acceptance_fraction">
<code class="descname">acceptance_fraction</code><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the fraction of steps accepted by each walker as an array.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.burn_in">
<code class="descname">burn_in</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_kombine.html#KombineSampler.burn_in"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.burn_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Use kombine’s <cite>burnin</cite> routine to advance the sampler.</p>
<p>If a minimum number of burn-in iterations was specified, this will run
the burn-in until it has advanced at least as many steps as desired.
The initial positions (p0) must be set prior to running.</p>
<p>For more details, see <cite>kombine.sampler.burnin</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>p</strong> (<em>numpy.array</em>) – An array of current walker positions with shape (nwalkers, ndim).</li>
<li><strong>lnpost</strong> (<em>numpy.array</em>) – The list of log posterior probabilities for the walkers at
positions p, with shape (nwalkers, ndim).</li>
<li><strong>lnprop</strong> (<em>numpy.array</em>) – The list of log proposal densities for the walkers at positions p,
with shape (nwalkers, ndim).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.chain">
<code class="descname">chain</code><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all past samples as an nwalker x niterations x ndim array.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.clear_chain">
<code class="descname">clear_chain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_kombine.html#KombineSampler.clear_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.clear_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Clears the chain and blobs from memory.</p>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.from_cli">
<em class="property">classmethod </em><code class="descname">from_cli</code><span class="sig-paren">(</span><em>opts</em>, <em>likelihood_evaluator</em>, <em>pool=None</em>, <em>likelihood_call=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_kombine.html#KombineSampler.from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance of this sampler from the given command-line
options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>opts</strong> (<em>ArgumentParser options</em>) – The options to parse.</li>
<li><strong>likelihood_evaluator</strong> (<em>LikelihoodEvaluator</em>) – The likelihood evaluator to use with the sampler.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A kombine sampler initialized based on the given arguments.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pycbc.inference.sampler_kombine.KombineSampler" title="pycbc.inference.sampler_kombine.KombineSampler">KombineSampler</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.lnpost">
<code class="descname">lnpost</code><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.lnpost" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the natural logarithm of the likelihood as an
nwalkers x niterations array.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.name">
<code class="descname">name</code><em class="property"> = 'kombine'</em><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>niterations</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_kombine.html#KombineSampler.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance the sampler for a number of samples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>niterations</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – Number of samples to get from sampler.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><strong>p</strong> (<em>numpy.array</em>) – An array of current walker positions with shape (nwalkers, ndim).</li>
<li><strong>lnpost</strong> (<em>numpy.array</em>) – The list of log posterior probabilities for the walkers at
positions p, with shape (nwalkers, ndim).</li>
<li><strong>lnprop</strong> (<em>numpy.array</em>) – The list of log proposal densities for the walkers at positions p,
with shape (nwalkers, ndim).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.set_state_from_file">
<code class="descname">set_state_from_file</code><span class="sig-paren">(</span><em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_kombine.html#KombineSampler.set_state_from_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.set_state_from_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the state of the sampler back to the instance saved in a file.</p>
<p>In addition to the numpy random state, the current KDE used for the
jump proposals is loaded.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – File with sampler state stored.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_kombine.KombineSampler.write_state">
<code class="descname">write_state</code><span class="sig-paren">(</span><em>fp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_kombine.html#KombineSampler.write_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_kombine.KombineSampler.write_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the state of the sampler in a file.</p>
<p>In addition to the numpy random state, the current KDE used for the
jump proposals is saved.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – File to store sampler state.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pycbc.inference.sampler_mcmc">
<span id="pycbc-inference-sampler-mcmc-module"></span><h2>pycbc.inference.sampler_mcmc module<a class="headerlink" href="#module-pycbc.inference.sampler_mcmc" title="Permalink to this headline">¶</a></h2>
<p>This modules provides classes and functions for using a MCMC sampler
for parameter estimation.</p>
<dl class="class">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler">
<em class="property">class </em><code class="descclassname">pycbc.inference.sampler_mcmc.</code><code class="descname">MCMCSampler</code><span class="sig-paren">(</span><em>likelihood_evaluator</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_mcmc.html#MCMCSampler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pycbc.inference.sampler_base.BaseMCMCSampler" title="pycbc.inference.sampler_base.BaseMCMCSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">pycbc.inference.sampler_base.BaseMCMCSampler</span></code></a></p>
<p>This class is used to construct the MCMC sampler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>likelihood_evaluator</strong> (<em>LikelihoodEvaluator</em>) – An instance of a pycbc.inference.likelihood evaluator.</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.blobs">
<code class="descname">blobs</code><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.blobs" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should return the blobs with a shape
nwalkers x niteration as requested by the BaseMCMCSampler class.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.chain">
<code class="descname">chain</code><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.chain" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should return the past samples as a
[additional dimensions x] niterations x ndim array, where ndim are the
number of sampling args, niterations the number of iterations, and
additional dimensions are any additional dimensions used by the
sampler (e.g, walkers, temperatures).</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.clear_chain">
<code class="descname">clear_chain</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_mcmc.html#MCMCSampler.clear_chain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.clear_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should clear the current chain of samples from memory.</p>
</dd></dl>

<dl class="classmethod">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.from_cli">
<em class="property">classmethod </em><code class="descname">from_cli</code><span class="sig-paren">(</span><em>opts</em>, <em>likelihood_evaluator</em>, <em>pool=None</em>, <em>likelihood_call=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_mcmc.html#MCMCSampler.from_cli"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.from_cli" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an instance of this sampler from the given command-line
options.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>opts</strong> (<em>ArgumentParser options</em>) – The options to parse.</li>
<li><strong>likelihood_evaluator</strong> (<em>LikelihoodEvaluator</em>) – The likelihood evaluator to use with the sampler.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A MCMC sampler initialized based on the given arguments.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#pycbc.inference.sampler_mcmc.MCMCSampler" title="pycbc.inference.sampler_mcmc.MCMCSampler">MCMCSampler</a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.lnpost">
<code class="descname">lnpost</code><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.lnpost" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should return the natural logarithm of the likelihood
function used by the sampler as an
[additional dimensions] x niterations array.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.name">
<code class="descname">name</code><em class="property"> = 'mcmc'</em><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.niterations">
<code class="descname">niterations</code><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.niterations" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current number of iterations.</p>
</dd></dl>

<dl class="attribute">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.p0">
<code class="descname">p0</code><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.p0" title="Permalink to this definition">¶</a></dt>
<dd><p>Since this is just a single chain, forces p0 to have shape (nparams,).</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>niterations</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_mcmc.html#MCMCSampler.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.run" title="Permalink to this definition">¶</a></dt>
<dd><p>This function should run the sampler.</p>
</dd></dl>

<dl class="method">
<dt id="pycbc.inference.sampler_mcmc.MCMCSampler.write_acceptance_fraction">
<code class="descname">write_acceptance_fraction</code><span class="sig-paren">(</span><em>fp</em>, <em>start_iteration=None</em>, <em>max_iterations=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pycbc/inference/sampler_mcmc.html#MCMCSampler.write_acceptance_fraction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pycbc.inference.sampler_mcmc.MCMCSampler.write_acceptance_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>Write acceptance_fraction data to file. Results are written to
<cite>fp[acceptance_fraction]</cite>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>fp</strong> (<a class="reference internal" href="pycbc.io.html#pycbc.io.inference_hdf.InferenceFile" title="pycbc.io.inference_hdf.InferenceFile"><em>InferenceFile</em></a>) – A file handler to an open inference file.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pycbc.inference">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pycbc.inference" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pycbc.inject.html" class="btn btn-neutral float-right" title="pycbc.inject package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="pycbc.frame.html" class="btn btn-neutral" title="pycbc.frame package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, 2016, 2017, Alexander Nitz, Ian Harry, Christopher M. Biwer, Duncan A.  Brown, Josh Willis, and Tito Dal Canton.
      Last updated on Aug 13, 2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'3b6f5b',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/typed.min.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>